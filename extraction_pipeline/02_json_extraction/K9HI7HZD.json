{
  "paper_id": "K9HI7HZD",
  "title": "Sample size calculators for planning stepped-wedge cluster randomized trials: a review and comparison",
  "abstract": "Recent years have seen a surge of interest in stepped-wedge cluster randomized trials (SW-CRTs). SW-CRTs include several design variations and methodology is rapidly developing. Accordingly, a variety of power and sample size calculation software for SW-CRTs has been developed. However, each calculator may support only a selected set of design features and may not be appropriate for all scenarios. Currently, there is no resource to assist researchers in selecting the most appropriate calculator for planning their trials. In this paper, we review and classify 18 existing calculators that can be implemented in major platforms, such as R, SAS, Stata, Microsoft Excel, PASS and nQuery. After reviewing the main sample size considerations for SW-CRTs, we summarize the features supported by the available calculators, including the types of designs, outcomes, correlation structures and treatment effects; whether incomplete designs, cluster-size variation or secular trends are accommodated; and the analytical approach used. We then discuss in more detail four main calculators and identify their strengths and limitations. We illustrate how to use these four calculators to compute power for two real SW-CRTs with a continuous and binary outcome and compare the results. We show that the choice of calculator can make a substantial difference in the calculated power and explain these differences. Finally, we make recommendations for implementing sample size or power calculations using the available calculators. An R Shiny app is available for users to select the calculator that meets their requirements ( https://douyang.shi  nyapps.io/swcrtcalculator/ ).",
  "year": 2025,
  "date": "2025-08-16",
  "journal": "BMC Med Res Methodol",
  "publication": "BMC Med Res Methodol",
  "authors": [
    {
      "forename": "Yongdong",
      "surname": "Ouyang",
      "name": "Yongdong Ouyang",
      "affiliation": "1  Clinical Epidemiology Program , Ottawa Hospital Research Institute , Ottawa , ON , Canada , \n\t\t\t\t\t\t\t\t Clinical Epidemiology Program \n\t\t\t\t\t\t\t\t Ottawa Hospital Research Institute \n\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t\t Ottawa \n\t\t\t\t\t\t\t\t\t ON \n\t\t\t\t\t\t\t\t\t Canada",
      "email": "youyang@ohri.ca"
    },
    {
      "forename": "Fan",
      "surname": "Li",
      "name": "Fan Li",
      "affiliation": "3  Department of Biostatistics , Yale School of Public Health , New Haven , CT , USA , \n\t\t\t\t\t\t\t\t Department of Biostatistics \n\t\t\t\t\t\t\t\t Yale School of Public Health \n\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t\t New Haven \n\t\t\t\t\t\t\t\t\t CT \n\t\t\t\t\t\t\t\t\t USA"
    },
    {
      "forename": "John",
      "surname": "Preisser",
      "name": "John Preisser",
      "affiliation": "5  Department of Biostatistics , University of North Carolina at Chapel Hill , Chapel Hill , NC , USA \n\t\t\t\t\t\t\t\t Department of Biostatistics \n\t\t\t\t\t\t\t\t University of North Carolina at Chapel Hill \n\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t\t Chapel Hill \n\t\t\t\t\t\t\t\t\t NC \n\t\t\t\t\t\t\t\t\t USA"
    },
    {
      "forename": "Monica",
      "surname": "Taljaard",
      "name": "Monica Taljaard",
      "affiliation": "1  Clinical Epidemiology Program , Ottawa Hospital Research Institute , Ottawa , ON , Canada , \n\t\t\t\t\t\t\t\t Clinical Epidemiology Program \n\t\t\t\t\t\t\t\t Ottawa Hospital Research Institute \n\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t\t Ottawa \n\t\t\t\t\t\t\t\t\t ON \n\t\t\t\t\t\t\t\t\t Canada"
    }
  ],
  "doi": "https://doi.org/10.13039/100000002",
  "arxiv": "arXiv:2205.14532",
  "keywords": [
    "Stepped-wedge design",
    "power",
    "sample size",
    "software",
    "correlation structures"
  ],
  "sections": [
    {
      "title": "Introduction",
      "text": "In recent years, the stepped-wedge cluster randomized trial (SW-CRT) design has been increasing in popularity.  [1] [2] 2] [3] [4]  In SW-CRTs (Figure  1a ), each cluster begins in the control condition. At different time points, clusters are randomized to cross over to the intervention condition until by the end of the trial, all clusters have received the intervention. In a complete SW-CRT design, measurements are taken from each cluster in each period. The SW-CRT can help facilitate recruitment when stakeholders perceive there are benefits to being exposed to the intervention at some point during the trial.  5, 6 The design is also attractive when the goal is to implement the intervention in all clusters but there are inadequate resources to do so in all clusters simultaneously.  5, 6 Despite their potential advantages, the use of stepped-wedge (SW) designs must be appropriately justified and researchers must be aware of the potential risks of bias.  7, 8 ethods for planning SW-CRTs are rapidly evolving and a variety of sample size calculation methods and tools are now available. Applied statisticians are faced with a bewildering array of choices and there is no centralized discussion of the functionalities of different calculators. We aim to provide a comprehensive overview of the trial design features that can be accommodated by available power and sample size calculators for SW-CRTs, illustrate how to use the main calculators and provide a guide to allow users to select the most appropriate calculators for their studies.\n\nThe rest of the article is organized as follows. We start with an overview of SW-CRTs, including major features to consider in sample size calculation. We then provide a detailed review of four main calculators including their strengths and limitations. Using two example trials, we then illustrate how to use these calculators to obtain power for each of the trials and compare the results across the four calculators. We conclude by summarizing our findings and making recommendations for selecting the most appropriate calculator in practice."
    },
    {
      "title": "Main factors to consider when planning a SW-CRT"
    },
    {
      "title": "Types of SW designs based on sampling structure",
      "text": "There are three main types of SW-CRTs, depending on the sampling structure.  9 In a cross-sectional design, outcomes are measured on different participants over time so each participant contributes outcomes to either the control or intervention condition but not both. In the closed cohort design, the same participants are measured repeatedly over time so each participant contributes outcomes under both the control and intervention conditions. The open cohort is a variation on the closed cohort in which participants may join or leave the cohort during the trial and thus at least some participants contribute outcomes under both control and intervention conditions.  10 The majority of work on sample size calculation for SW-CRTs has focused on crosssectional or closed cohort designs; open cohort designs have received relatively little development except for the work by Kasza et al.  10  Recent work has started to consider cross-sectional designs arising from the common scenario in which participants are recruited continuously in time (but exposed for only a short period) as a special class of design requiring different correlation structures, called 'continuous-time decay', and different analytical approaches.  9, 11 Further work is required but some methodology for continuous-time decay has already been developed by Grantham et al.  12  that includes an R Shiny web app to determine power for some scenarios, assuming individual measurement times are evenly spaced within each interval. In practice, cross-sectional designs are often considered to be approximations of continuous recruitment short exposure designs and, depending on the assumed correlation structure, sample size calculators based on discrete sampling may yield identical calculations."
    },
    {
      "title": "Incomplete designs",
      "text": "Standard SW-CRTs collect data in each cluster period. Incomplete SW-CRTs are designs that do not collect data in all cluster periods.  13, 14 Figure  1b  illustrates a design in which no data are collected during the period immediately prior to the intervention. These 'transition periods' allow extra time to implement the intervention or for the intervention to start exerting its effect. Each sequence can have one or more transition periods.  14 Figure  1c  illustrates a design in which each cluster has the same number of control and intervention periods, but not all clusters enter and exit at the same time. This type of design is called a staircase design.  15"
    },
    {
      "title": "Correlation structures and statistical models for SW-CRTs",
      "text": "In a SW-CRT, the intervention effect is partially confounded with the time effect (i.e. secular trend) by design; therefore, the analytical model must always account for time to obtain unbiased inferences. It is further well known that CRTs must account for the correlation among multiple responses from different individuals within the same cluster. In a post-test-only parallel-arm CRT, the degree of clustering is usually measured using a single intra-cluster correlation coefficient (ICC), defined as the ratio of the between-cluster variance and the sum of the between-cluster and within-cluster variances.  16 In multi-period CRTs, such as SW-CRTs, correlation structures may be more complex as outcomes are measured in different periods. Nevertheless, the initial statistical model for SW-CRTs developed by Hussey and Hughes was a random intercepts model that assumed a single exchangeable correlation, i.e. the correlation between any two individuals from the same cluster is the same regardless of their distance apart in time.  2  Building upon earlier work on multi-period parallel-arm CRTs,  17  Hooper et al.  18  and separately Girling and Hemming  19  introduced a conditional (i.e. mixed-effects) model (referred to as the Hooper/Girling model) that allows the within-period ICC (wp-ICC) (i.e. the correlation between two individuals from the same cluster and same period) to differ from the between-period ICC (bp-ICC) (i.e. the correlation between two individuals from the same cluster but different periods). We would typically expect the bp-ICC to be less than the wp-ICC. The ratio of the bp-ICC and wp-ICC is called the Cluster Autocorrelation Coefficient (CAC), which is typically <1.  18, 20 Li 21 referred to this as a nested exchangeable correlation structure. In a cohort design, an additional correlation is needed to account for repeated measures on the same individual over time. In the Hooper/Girling model, this correlation was introduced through the addition of a patient-level random effect and quantified as an Individual Autocorrelation Coefficient (IAC), which implies a constant correlation in the repeated measures on the same individual over time.  18 Li 21 referred to this as a block exchangeable correlation structure.\n\nIntuitively, within a cluster, the responses from individuals between two consecutive periods are usually more correlated than those separated by a longer interval. Therefore, assuming a constant bp-ICC may not be realistic, Kasza et al.  22  proposed an extension to the Hooper/ Girling model that allows the bp-ICC to decay exponentially. In this case, the CAC refers to the rate of exponential decay per period. In the case of a cohort design, individuallevel correlation is also required and there are two possibilities: either a constant individual-level correlation over time (specified through an IAC) or allowing individuallevel correlations to decay exponentially (referred to as the proportional decay structure).  21 s an alternative to mixed-effects models, Li et al.  23  proposed a marginal model based on generalized estimating equations (GEE) and corresponding power and sample size calculation methodology allowing for both crosssectional and closed cohort SW-CRT designs. In a cohort setting, it is worth noting that in a marginal model, the correlation in repeated measures on the same individual is modelled directly through the within-individual ICC (wi-ICC) and is not identical to the IAC referred to above in the context of a mixed-effects model. A comprehensive overview of statistical models available for SW-CRTs can be found in Li et al.  24  In addition to the above correlation structures that are based on time (period), correlation structures can also be allowed to depend on exposure. This is referred to as cluster-treatment effect heterogeneity and is accomplished by including a random cluster by treatment effect in the analytical model.  25, 26 fferent ways to specify treatment effects\n\nThe most common way to model a treatment effect in a SW-CRT is as a time-averaged effect (step/immediate change),  2  which implies an immediate effect that is sustained. With this specification, the average response across the intervention periods is compared with that across the control periods (Figure  2a ). In some situations, the intervention will not be fully implemented in the period immediately after crossing over or may have a delayed effect. This can be handled by specifying a fractional treatment indicator.  2, 25 For example, using prior knowledge, one may specify that the treatment will only be 50% effective during the first intervention period and code the treatment indicator as 0.5 in that period. When the treatment effect is anticipated to be gradual across multiple periods, one can assign fractional values to consecutive periods (assuming the fractions are known) (Figure  2b ). More generally, rather than estimating a single treatment effect, one may allow the treatment effect to vary in an unrestricted way according to the number of periods of exposure to the intervention. This is referred to as general time-on-treatment effects  24, 25  ; it requires that an adequate number of clusters are available given the desired number of treatment effects. A more parsimonious version is to assume a constant (linear) change with increasing duration of exposure (called a linear time-on-treatment effect).  24 Linear time-ontreatment can also be viewed as a special case of fractional treatment indicators but where the fractions are equally spaced and determined by the maximum exposure time (Figure  2c )."
    },
    {
      "title": "Analytical approximation for non-continuous outcomes",
      "text": "For non-continuous (binary and count) outcomes, a common approach to sample size calculation is to use the normal approximation.  2, 27 However, this approach has several issues. First, it requires the specification of an absolute difference even if relative measures are of interest. Second, the variance of the estimated treatment effect for non-continuous outcomes theoretically depends on the assumed treatment effect as well as on the size of any time effects, whereas under the normal approximation it depends on neither. Several recent methods have shifted away from normal approximation approaches towards methods based on maximum-likelihood estimation (MLE)  28  of the generalized linear mixed-model (GLMM) or marginal models using GEE.  23, 29 These methods allow users to specify odds ratios and risk ratios directly in their sample size calculation procedures. Moreover, they allow the variance to depend on the assumed treatment effect and thus require the effect of secular trends to be incorporated in the power calculation. Although the analytical model should always include time effects to account for potential secular trends, power calculations for continuous outcomes are not affected by the magnitude of the secular trends.\n\nTable  1  summarizes these and other features that researchers need to consider when designing a SW-CRT."
    },
    {
      "title": "Summary of available sample size and power calculators",
      "text": "To date, 18 power and sample size calculators for SW-CRTs have been developed for implementation in R, online via an R Shiny app, or in SAS, Stata, Excel, PASS  31  and nQuery.  32 A standalone calculator maintained by the National Institutes of Health has also recently become available.  33 A summary of the functionality of the calculators with respect to the major features described in Table  1  is presented in Supplementary File 1, Tables S1-S6 (available as Supplementary data at IJE online) organized by software platform. Each calculator is also classified based on how correlation structures need to be specified (i.e. in  Allow the between-period ICC to be different from the within-period ICC (often specified using the CAC, which is the ratio of the between-period to the within-period ICC) Exponential decay Specify a within-period ICC and a CAC measuring the exponential rate of decay in the between-period ICC per period Cohort designs Exchangeable As for cross-sectional design; in addition, assume a constant within-individual correlation over time Block exchangeable\n\nAs for cross-sectional design; in addition, assume a constant within-individual correlation over time Proportional decay\n\nAs for cross-sectional design; in addition, specify an exponential decay in the within-individual correlation over time Type of treatment effect Average (immediate) effect Intervention leads to step change (immediate change) Delayed or gradual effect Allows gradual treatment effect or partial exposure to the intervention Linear time-on-treatment effect Allows the treatment to increase linearly with duration of exposure General time-on-treatment effect Allows the treatment effect to vary in an unrestricted way, according to the number of periods of exposure to the intervention Link function (for binary outcomes) Identity (Risk Difference), Log (Relative Risk), Logit (Odds Ratio) Equal or Unequal allocation Same or different number of clusters per sequence; calculators that allow users to upload a userdefined design matrix may allow users to explore power implications of different allocations Varying or fixed cluster sizes Allowing cluster (or cluster-period) sizes to vary across clusters can affect power. Often specified in terms of a coefficient of cluster-size variation Incomplete design Data are not collected from some clusters in some periods either to allow for a transition period or to ease the data collection burden (see Figure  1 ). Calculators that allow users to upload or define their own design matrix provide more flexibility over specifying incomplete designs Analytic model Mixed-effects regression or marginal model (generalized estimating equations) Different methods to specify correlation Different calculators may require different inputs to measure correlation. The most common approach is to specify anticipated intra-cluster correlation coefficients. An alternative is to specify the anticipated variance or standard deviation of the random-effects distributions. Finally, the coefficient of outcome variation can sometimes be specified Cluster-treatment heterogeneity Users may allow treatment effects to vary randomly across clusters (which can reduce power) Multilevel clustering More than two levels of clustering during each time period, e.g. patients may be clustered within providers who are clustered within primary care practices Hybrid design\n\nThe design contains a mixture of SW-CRT and parallel CRT (see Girling et al.  19"
    },
    {
      "title": "for details) Continuous or categorical time effects",
      "text": "Users may model secular trends using fixed categorical or fixed continuous effects. Whether linear or categorical time effects are incorporated in complete stepped-wedge designs has no influence on continuous outcomes  30"
    },
    {
      "title": "Magnitude of time effect",
      "text": "Users may specify the expected secular trend, which, in the case of a non-continuous outcome, can affect power ICC, intra-cluster correlation coefficient; CAC, Cluster Autocorrelation Coefficient; SW-CRT, stepped-wedge cluster randomized trial; CRT, cluster randomized trial.\n\nterms of coefficient of variation (CV) of outcomes, ICCs or variance components of random effects) and whether the calculator allows for unequal cluster-period sizes, unequal allocation of clusters to sequences and whether the user can specify their own design matrix. Note that any calculator that can support a user-specified design matrix can typically also be used for other multiple-period designs (such as repeated parallel-arm or multiple-period cluster crossovers) as the sample size methodology underlying all these designs is similar. We also indicate whether clustertreatment effect heterogeneity, continuous time effects (as opposed to only categorical), subclusters (i.e. more than two levels of clusters within each period) and hybrid designs (i.e. a mixture of parallel and SW-CRTs) can be accommodated.  19 A Shiny app is available ( https://douyang.  shinyapps.io/swcrtcalculator/ ) in which users can obtain a list of calculators that accommodate their selected design features. Among available calculators, we now review in more detail four main packages that offer many of the available features."
    },
    {
      "title": "SHINYCRT by Hemming et al."
    },
    {
      "title": "Overview",
      "text": "\u2022 A menu-based web app (RShiny app) that calculates power and sample size for SW-CRTs under linear mixedeffects models.  27  Type of design and outcome: cross-sectional and closed cohort designs with continuous, binary and count outcomes using the normal approximation method. \u2022 Correlation structures: exchangeable (users need to specify a common wp-ICC); block or nested exchangeable (specify the wp-ICC and CAC as well as an IAC for cohort designs); exponential decay (specify the wp-ICC and CAC for the decay per period, as well as a constant IAC for cohort designs). Exponential decay is referred to as 'discrete time decay' in this app.\n\nImportant features and strengths SHINYCRT automatically displays power or sample size curves. Users can either provide sample sizes per cluster period to calculate the power or specify a target power to obtain the required sample sizes. In addition to the specified 'base' ICC values, users can conduct a sensitivity analysis by specifying the upper and lower bounds of the wp-ICC. The plot will automatically include results for lower and higher CAC values (80% and 120% of the specified CAC) as a sensitivity analysis. Users can upload their own design matrices to accommodate unequal numbers of clusters per sequence. Uploading a design matrix also activates additional features including an option for accommodating clustertreatment heterogeneity. The design matrix may contain empty cells to allow for incomplete designs or cells with fractions to accommodate delayed or linear time-ontreatment effects (although the design matrix will be displayed as integers). This calculator can also accommodate unequal cluster sizes by specifying a CV for cluster-size variation. Instead of a z-test, users can request a t-test with degrees of freedom equal to the number of cluster periods minus the number of periods minus one, although the t-test is not available for exponential decay or when uploading a user-specified design matrix. An attractive feature of this app is that in addition to SW-CRT, menu options include other multiple-period designs, e.g. parallel-arm and multiple-period cluster crossover designs."
    },
    {
      "title": "Limitations",
      "text": "The SHINYCRT web app has multiple features and allows substantial flexibility in specifying a design, but also has some limitations. First, methods for binary and count outcomes use a normal approximation; thus, the magnitude of time effects on power cannot be accommodated. Second, only identity link functions are allowed; thus, when the research requires log or logit links, the sample size calculation procedure may not be compatible with the analytical approach. Third, in the case of closed cohort designs, the app only allows constant individual-level correlation, even though proportional decay may be more appropriate. Fourth, the t-distribution approximation was still under development at the time of submission. Finally, the RShiny app platform limits the number of hours the app can run on the server. When the quota has been reached in a particular month, users will have to find an alternative way to access the calculator."
    },
    {
      "title": "SWDPWR by Chen et al."
    },
    {
      "title": "Overview",
      "text": "\u2022 A calculator running in R, RShiny and SAS that calculates power and sample size for SW-CRTs using GEE or GLMM with MLE.  34  Type of design and outcome: cross-sectional and closed cohort designs with continuous and binary outcomes under identity, log and logit link functions. \u2022 Correlation structures: block or nested exchangeable correlation structures (including exchangeable as a special case); wp-ICC and bp-ICC must be specified for cross-sectional designs (specified as equal to obtain exchangeable correlation); for cohort designs, wi-ICC must also be specified."
    },
    {
      "title": "Important features and strengths",
      "text": "The most significant feature of this calculator is the availability of GEE and MLE to obtain more accurate sample size estimates for binary outcomes. When the research requires relative measures, the implementation of log and logit link functions allows users to specify relative treatment effects directly. When assuming no secular trend, users can specify the target difference by either (i) specifying the expected response in the control condition at the beginning of the study and the expected response in the intervention condition at the end or (ii) replacing the expected response in the intervention condition at the end of the study with the effect size. To accommodate a secular trend, users can specify the expected response in the control condition at the beginning and end of the study (i.e. assuming the intervention has not been introduced) in addition to the target difference. Users can upload a design matrix and accommodate hybrid designs and designs with different numbers of clusters per sequence."
    },
    {
      "title": "Limitations",
      "text": "The SWDPWR calculator has some limitations. First, it does not allow for exponential or proportional decay and cannot accommodate count outcomes. Second, with the conditional model, a maximum cluster-period size of 150 is allowed for binary outcomes and the calculator is further limited to cross-sectional designs with exchangeable correlation. If larger cluster-period sizes, cohort designs or more complex correlation structures are desired, GEE must be used instead. Third, when specifying no time effects, i.e. the same expected response in the control condition at the beginning and end, the time variable will be removed from the underlying model used for calculation, which is incompatible with recommendations to always include time effects in the analytical model. Fourth, there is currently no option for choosing a t-test when the number of clusters is small. Finally, incomplete designs (including transition periods), cluster-treatment heterogeneity, unequal cluster sizes and delayed or time-on-treatment effects are not available."
    },
    {
      "title": "SWCRTDESIGN by Hughes et al."
    },
    {
      "title": "Overview",
      "text": "\u2022 A calculator running in R and RShiny app that calculates power and sample size for SW-CRTs under a linear mixed-effects model.  35  Type of design and outcome: cross-sectional designs with continuous and binary outcomes under an identity link function. For non-continuous outcomes, a new method that includes log and logit link functions and that can provide more accurate estimates than MLE even with a small number of clusters is being planned as a future addition.  36  Correlation structure: exchangeable and nested exchangeable correlation structures. Users can specify the wp-ICC and CAC or standard deviations for random intercepts, random treatment effects across clusters and random cluster by time effects; the correlation between random intercepts and random treatment effects can also be specified (most other calculators assume independence)."
    },
    {
      "title": "Important features and strengths",
      "text": "The most important contribution of this package is to allow the intervention effect to vary across clusters by including a random treatment effect.  25 To activate this feature, users must input standard deviations of the anticipated random effects (rather than ICCs). In the accompanying Shiny app, delayed or linear time-on-treatment effects can be accommodated by allowing fractional treatment indicators; however, general time-on-treatment effects are not available. Designs must be specified via the function 'swDns'. Users can specify the number of clusters changing from control to intervention at each step. An incomplete design can be constructed by specifying a cluster-period size of 0 in select periods."
    },
    {
      "title": "Limitations",
      "text": "SWCRTDESIGN has several limitations. First, calculations for binary outcomes are only available using the normal approximation and for count outcomes only via simulation. Second, it cannot be used for cohort designs. Third, exponential or proportional decay cannot be accommodated. Fourth, there is no option for choosing a t-distribution when the number of clusters is small. Fifth, compared with other packages, specifying incomplete designs is less straightforward: a complete design matrix must be specified using 'swDns' followed by specification of clusterperiod sizes. Finally, delayed treatment effects are only available in the Shiny app version so far, but relevant code for simulation-based power calculation can be performed by modifying the code provided in Voldal et al.  35"
    },
    {
      "title": "CRTFASTGEEPWR by Zhang and Preisser"
    },
    {
      "title": "Overview",
      "text": "\u2022 An SAS macro that calculates power for SW-CRT based on GEE analysis of a marginal model.  37, 38  Type of design and outcome: cross-sectional or closed cohort designs with continuous, binary and count outcomes and identity, log and logit link functions.\n\n\u2022 Correlation structure: nested or block exchangeable (including exchangeable as a special case) and exponential or proportional decay. Under proportional decay, the calculator requires the bp-ICC and wi-ICC to decay at the same rate."
    },
    {
      "title": "Important features and strengths",
      "text": "Users can specify either time-averaged or 'incremental' intervention effects, the latter using fractional treatment values for linear time-on-treatment effects. Additionally, time effects can be specified as either categorical or linear (continuous). Both intervention and time effects are specified as regression parameters on the scale of the link function. The model with categorical time effects implies an expected proportion/rate under the control condition for each time period, whereas specification of linear time effects requires the user to specify both a fixed intercept and slope that determine marginal means for the outcome under the control condition.\n\nUsers are required to enter the number of clusters per sequence, which may vary. A required design pattern matrix for sequence-periods uses 0 for control periods, 1 for intervention periods and 2 for empty cells (for incomplete designs). Users may determine power for the normal approximation or from a t-distribution with choice of degrees of freedom (the number of clusters minus two or the number of clusters minus the number of parameters in the model). Unequal cluster-period sizes can be accommodated; however, users must enter the cluster-period sizes rather than a single CV."
    },
    {
      "title": "Limitations",
      "text": "There are few limitations to this calculator. First, clustertreatment effect heterogeneity cannot be accommodated. Second, for binary and count outcomes, the magnitude of secular trends is relevant but the calculator only considers these parameters on the link function scale, so the user will need to use inverse link functions to convert proportions and rates in case of a non-identity link.  23"
    },
    {
      "title": "Other calculators",
      "text": "The above four calculators may cover most scenarios of interest; features of other available calculators are summarized in the tables and available in our app and only briefly highlighted here. For Stata users, POWERSWGEE  39  might offer the most flexibility and has similar functionalities as CRTFASTGEEPWR. Notably, when specifying the proportional decay structure, it allows bp-ICC and individual-level correlation to decay at different rates. However, POWERSWGEE currently cannot accommodate incomplete designs. A few calculators in our review accommodate special features, e.g. designs with subclusters  40  ; a calculator is also available to determine allocation-based power.  41, 42 The choice of calculators that can deal with open cohort designs is limited  10, 43  ; however, a reviewer pointed out that by multiplying IAC by one minus the churn rate (the rate that participants leave the trial), calculators that support closed cohort designs can also be used for open cohort designs. This observation will hold for continuous outcomes under a constant individuallevel correlation. Conversely, calculators for open cohort designs can also support closed cohort and cross-sectional designs by setting the churn rate to 0 or 1.\n\nDuring peer review, a new standalone calculator (SWGRT 33 ) became available and was added to our manuscript. SWGRT can support continuous and binary outcomes, all three types of designs and available correlation structures, and is accompanied by excellent documentation. A notable feature of this calculator is that it can incorporate the effect of covariate adjustments in the design. It also allows an ICC obtained from a block exchangeable model to be converted to a discrete time decay ICC.  10  However, it is based on the normal approximation for binary outcomes and cannot deal with incomplete designs, unequal allocation and user-specified design matrices. Finally, it only allows the calculation of the required number of clusters per sequence for a pre-specified treatment effect and a minimum of two clusters per sequence is required."
    },
    {
      "title": "Examples",
      "text": "In this section, we illustrate power calculations using each of the four packages for two published trials: Girls on the Go!  44  and the Washington State Expedited Partner Therapy (EPT) trial.  45 We show how the sample size parameters should be specified in each package and compare the obtained power values across the four packages. We make comparisons under exchangeable, nested or block exchangeable and exponential or proportional decay structures. We were able to obtain realistic parameter values under these correlation structures using real data from both trials. The code used to implement the calculations is presented in Sections 1 and 2 of Supplementary File 2 (available as Supplementary data at IJE online) or RPubs ( https://rpubs.com/derek6561/swcrtcalculator ).\n\n'Girls on the Go!' trial 'Girls on the Go!' is a closed cohort SW-CRT designed to determine whether a 10-week programme that incorporates interactive and practical learning would help to increase self-esteem, self-confidence and body image among school girls aged 10-16 years in Melbourne, Victoria, Australia.  44 The trial was designed with three sequences and four periods with two clusters per sequence (a total of six clusters) and 10 participants per cluster, i.e. a total sample size of 60 participants. There were no transition periods. The primary outcome was continuous: a measure of selfesteem on a scale from 0 to 40. The sample size parameter values including ICC estimates under the three different correlation structures from the CLOUDbank data set, which is a repository of ICC values under different correlation structures, are summarized in Table  2 .  46  Due to the small number of clusters, we illustrate power with both a z-test and a t-test. SWCRTDESIGN was excluded from this example as it cannot be used for cohort designs. Power calculations when using SWDPWR and CRTFASTGEEPWR are shown both with and without time effects. (This does not contradict an earlier statement that the magnitude of time effects is irrelevant for continuous outcomes but was included to illustrate how SWDPWR handles time effects compared with other packages.)\n\nThe power when using the three main calculators under these assumptions is presented in Table  3 . Not surprisingly, the power did not differ much whether GLMM or GEE was used. Whereas power was substantially different under different correlation structures, power was similar across the different calculators when using the normal distribution. Under the no-time-effect scenario however, SWDPWR yields substantially higher power due to fixed time effect parameters being excluded from the model, leaving fewer fixed parameters to estimate. Therefore, to approximate the results of CRTFASTGEEPWR assuming a null secular trend (where the analytical model includes time effects), users must specify a small secular trend in SWDPWR. As expected, the magnitude of time effects in the linear model is irrelevant to CRTFASTGEEPWR. Note that power from CRTFASTGEEPWR is based on an exponentially decaying wi-ICC, whereas SHINYCRT assumes a constant IAC; nevertheless, the power obtained was comparable. When using the t-distribution, calculated power in SHINYCRT and CRTFASTGEEPWR were substantially different (76% vs 50%) due to the degrees of freedom implemented being different (19 in SHINYCRT vs 4 in CRTFASTGEEPWR, i.e. the number of clusters minus two)."
    },
    {
      "title": "Community EPT trial",
      "text": "The Washington State EPT trial is a cross-sectional SW-CRT designed to evaluate the impact of promoting the use of EPT on the decrease of Chlamydia test positivity among women.  45 The trial was designed with four sequences and five periods. Each sequence has 6, 6, 6 and 4 clusters, respectively (a total of 22 clusters). The average clusterperiod size was 305 participants, i.e. a total sample size of 33 550 participants. There were no transition periods. The primary outcome was binary: prevalence of Chlamydia positivity. The sample size parameter values including ICC estimates under the three different correlation structures, from reanalysis of the real EPT trial data,  47, 48  are summarized in Table  4 . Since the magnitude of any assumed time effects will impact the power for binary outcomes, we assessed power assuming (i) no time effect, (ii) a small time effect equal to half the size of the treatment effect and (iii) a moderate time effect equal to the treatment effect.\n\nThe power when using the four main calculators is presented in Table  5 . The power was dramatically different under different assumed correlation structures. The power did not appear to differ based on whether GLMM or GEE was used, but when assuming no time effects, SWDPWR a SHINYCRT requires IAC; SWDPWR and CRTFASTGEEPWR require within-individual ICC. We used the same value for both parameters. b Assumed 0.1 in SWDPWR where specification of time effects is necessary to avoid inflating power; changing the value of assumed time effects will not change power as the outcome is continuous gave substantially different results to the other packages, as explained earlier. When the time effects were not null, the power from SWDPWR and CRTFASTGEEPWR was similar but substantially different from the power under the normal approximation in SHINYCRT and SWCRTDESIGN (since the normal approximation does not rely on the magnitude of time effects). The differences tend to increase when the time effects increase.\n\nThe logit link can also be specified for the mean model in SWDPWR and CRTFASTGEEPWR (see Supplementary File 2, Section 3, available as Supplementary data at IJE online). Both calculators require users to specify the effect size on the log scale and the ICC of the binary outcomes on the proportions scale. Whereas SWDPWR requires the time effect to be specified as proportions, CRTFASTGEEPWR requires all marginal mean model parameters (i.e. period and intervention effects) to be specified on the link function scale."
    },
    {
      "title": "Summary and recommendations",
      "text": "There are several key considerations when designing a SW-CRT and choosing a power and sample size calculator. For a continuous or non-continuous outcome when the normal approximation is appropriate (i.e. where there is a relatively large number of clusters and/or the anticipated proportion is not too close to 0 or 1) and when anticipated secular trends are small, SHINYCRT is potentially the best choice for most users. It is free to access and provides an intuitive interface. It can accommodate continuous, binary and count outcomes as well as cross-sectional and closed cohort designs under the three types of correlation structures. It allows for incomplete designs and cluster-treatment heterogeneity. Furthermore, it automatically implements a sensitivity analysis for the assumed correlation parameters. However, for non-continuous outcomes in which relative effects are of interest or when extreme baseline rates/proportions or large time effects are expected, CRTFASTGEEPWR seems to be the better choice. This SAS macro allows for cross-sectional and closed cohort designs, incorporates all correlation structures considered herein and can accommodate incomplete designs, fractional treatment effects and both categorical and linear time effects. However, non-SAS users or users who do not want to use GEE may use SWDPWR instead as long as they have a complete design with a continuous or binary outcome (exchangeable correlation only) and do not require decaying correlation structures or delayed treatment effects. When using SWDPWR, users should incorporate non-zero time effects (even for continuous outcomes), otherwise the calculation will be based on a model that excludes the time effect coefficients and this could yield spuriously high power. g This is a manual correction for the DF used in SHINYCRT based on its documentation; the actual implementation is under development.\n\nAlthough users may select the calculator most convenient to them facilitated by our Shiny app, a good rule of thumb when not all requirements can be met is to prioritize those factors that have the most impact on power in their scenario. As our examples illustrate, an important consideration is the assumed correlation structure: assuming an overly simple correlation structure (e.g. exchangeable) when a more complex correlation structure (e.g. block exchangeable or exponential decay) is appropriate can lead to power being overestimated.  49 Ideally, ICC values should be informed by analysing existing data (e.g. historical or routinely collected data) under a similar setting over a similar study duration. A practical approach is to select the best-fitting correlation structure based on information criteria, i.e. AIC (Akaike Information Criterion) and BIC (Bayesian Information Criterion).  50 egardless of the availability of prior data, it is always good practice to check the sensitivity of the calculations by assuming a range of plausible ICC values. When there are no prior data to inform the choice of correlation structure, we would recommend using a nested or block exchangeable correlation for binary outcomes and exponential or proportional decay for continuous outcomes. For non-continuous outcomes, the type of approximation used is also critical. For non-continuous outcomes, users must consider whether strong time effects are anticipated and choose a calculator that can accommodate such effects. As shown in our example, with binary outcomes, the normal approximation works poorly if the baseline proportion is away from 0.5 and the time effect is not null. A similar observation was made by Zhou et al.  28  Finally, for continuous outcomes with a small number of clusters, using the t-test is generally advised, but users must be aware that different degree-of-freedom options are implemented in different calculators and the best choice for degree of freedom remains unclear."
    },
    {
      "text": "Figure 1 (a) Stepped-wedge design with five sequences and six periods (steps). (b) Stepped-wedge design with transition periods. (c) 'Staircase' stepped-wedge design."
    },
    {
      "text": "Figure 2 (a) Design matrix for a stepped-wedge design with time-averaged treatment effect. (b) Design matrix for a stepped-wedge design with delayed/gradual treatment effect and known fractions. (c) Design matrix for a stepped-wedge design with linear time-on-treatment effects (treatment increases linearly with duration of exposure)."
    },
    {
      "text": "Common features that users need to consider or specify when designing a stepped-wedge cluster randomized trial"
    },
    {
      "text": "Sample size calculation parameter values used for the 'Girls on the Go' trial (continuous outcome)"
    },
    {
      "text": "Power calculated under the main software packages for the 'Girls on the Go' trial"
    },
    {
      "text": "Sample size calculation parameter values used for the Expedited Partner Therapy trial (binary outcome)"
    },
    {
      "text": "Power calculated under the main software packages for the Expedited Partner Therapy trial"
    }
  ],
  "references": [
    {
      "title": "The stepped wedge trial design: a systematic review",
      "authors": [
        "C Brown",
        "R Lilford"
      ],
      "year": 2006
    },
    {
      "title": "Design and analysis of stepped wedge cluster randomized trials",
      "authors": [
        "M Hussey",
        "J Hughes"
      ],
      "year": 2007,
      "doi": "10.1016/j.cct.2006.05.007"
    },
    {
      "title": "Systematic review of stepped wedge cluster randomized trials shows that design is particularly used to evaluate interventions during routine implementation",
      "authors": [
        "N Mdege",
        "M-S Man",
        "Taylor Brown"
      ],
      "year": 2011
    },
    {
      "title": "The stepped wedge cluster randomised trial: rationale, design, analysis, and reporting",
      "authors": [
        "K Hemming",
        "T Haines",
        "P Chilton"
      ],
      "year": 2015,
      "doi": "10.1136/bmj.h391"
    },
    {
      "title": "Five questions to consider before conducting a stepped wedge trial",
      "authors": [
        "J Hargreaves",
        "A Copas",
        "E Beard"
      ],
      "year": 2015
    },
    {
      "title": "Logistic, ethical, and political dimensions of stepped wedge trials: critical review and case studies",
      "authors": [
        "A Prost",
        "A Binik",
        "I Abubakar"
      ],
      "year": 2015,
      "doi": "10.1186/s13063-015-0837-4"
    },
    {
      "title": "Reflection on modern methods: when is a stepped-wedge cluster randomized trial a good study design choice?",
      "authors": [
        "K Hemming",
        "M Taljaard"
      ],
      "year": 2020
    },
    {
      "title": "Introducing the new CONSORT extension for stepped-wedge cluster randomised trials",
      "authors": [
        "K Hemming",
        "M Taljaard",
        "J Grimshaw"
      ],
      "year": 2019
    },
    {
      "title": "Designing a stepped wedge trial: three main designs, carry-over effects and randomisation approaches",
      "authors": [
        "A Copas",
        "J Lewis",
        "J Thompson"
      ],
      "year": 2015
    },
    {
      "title": "Sample size and power calculations for open cohort longitudinal cluster randomized trials",
      "authors": [
        "J Kasza",
        "R Hooper",
        "A Copas"
      ],
      "year": 2020,
      "doi": "10.1002/sim.8519"
    },
    {
      "title": "Stepped wedge trials with continuous recruitment require new ways of thinking",
      "authors": [
        "R Hooper",
        "A Copas"
      ],
      "year": 2019
    },
    {
      "title": "Accounting for a decaying correlation structure in cluster randomized trials with continuous recruitment",
      "authors": [
        "K Grantham",
        "J Kasza",
        "S Heritier"
      ],
      "year": 2019,
      "doi": "10.1002/sim.8089"
    },
    {
      "title": "Information content of cluster-period cells in stepped wedge trials",
      "authors": [
        "J Kasza",
        "A Forbes"
      ],
      "year": 2019
    },
    {
      "title": "Stepped-wedge cluster randomised controlled trials: a generic framework including parallel and multiple-level designs",
      "authors": [
        "K Hemming",
        "R Lilford",
        "A Girling"
      ],
      "year": 2015
    },
    {
      "title": "The hunt for efficient, incomplete designs for stepped wedge trials with continuous recruitment and continuous outcome measures",
      "authors": [
        "R Hooper",
        "J Kasza",
        "A Forbes"
      ],
      "year": 2020,
      "doi": "10.1186/s12874-020-01155-z"
    },
    {
      "title": "Design considerations in the estimation of intraclass correlation",
      "authors": [
        "A Donner",
        "J Koval"
      ],
      "year": 1982,
      "doi": "10.1111/j.1469-1809.1982.tb00718.x"
    },
    {
      "title": "Analysis of data from group-randomized trials with repeat observations on the same groups",
      "authors": [
        "D Murray",
        "P Hannan",
        "R Wolfinger"
      ],
      "year": 1998
    },
    {
      "title": "Sample size calculation for stepped wedge and other longitudinal cluster randomised trials",
      "authors": [
        "R Hooper",
        "S Teerenstra",
        "E De Hoop"
      ],
      "year": 2016,
      "doi": "10.1002/sim.7028"
    },
    {
      "title": "Statistical efficiency and optimal design for stepped cluster studies under linear mixed effects models",
      "authors": [
        "A Girling",
        "K Hemming"
      ],
      "year": 2016,
      "doi": "10.1002/sim.6850"
    },
    {
      "title": "Intra-cluster and inter-period correlation coefficients for cross-sectional cluster randomised controlled trials for type-2 diabetes in UK primary care",
      "authors": [
        "J Martin",
        "A Girling",
        "K Nirantharakumar"
      ],
      "year": 2016,
      "doi": "10.1186/s13063-016-1532-9"
    },
    {
      "title": "Design and analysis considerations for cohort stepped wedge cluster randomized trials with a decay correlation structure",
      "authors": [
        "F Li"
      ],
      "year": 2020,
      "doi": "10.1002/sim.8415"
    },
    {
      "title": "Impact of non-uniform correlation structure on sample size and power in multiple-period cluster randomised trials",
      "authors": [
        "J Kasza",
        "K Hemming",
        "R Hooper"
      ],
      "year": 2019,
      "doi": "10.1177/0962280217734981"
    },
    {
      "title": "Sample size determination for GEE analyses of stepped wedge cluster randomized trials",
      "authors": [
        "F Li",
        "E Turner",
        "J Preisser"
      ],
      "year": 2018,
      "doi": "10.1111/biom.12918"
    },
    {
      "title": "Mixed-effects models for the design and analysis of stepped wedge cluster randomized trials: an overview",
      "authors": [
        "F Li",
        "J Hughes",
        "K Hemming"
      ],
      "year": 2021,
      "doi": "10.1177/0962280220932962"
    },
    {
      "title": "Current issues in the design and analysis of stepped wedge trials",
      "authors": [
        "J Hughes",
        "T Granston",
        "P Heagerty"
      ],
      "year": 2015,
      "doi": "10.1016/j.cct.2015.07.006"
    },
    {
      "title": "Modeling clustering and treatment effect heterogeneity in parallel and stepped-wedge cluster randomized trials",
      "authors": [
        "K Hemming",
        "M Taljaard",
        "A Forbes"
      ],
      "year": 2018
    },
    {
      "title": "A tutorial on sample size calculation for multiple-period cluster randomized parallel, cross-over and stepped-wedge trials using the Shiny CRT Calculator",
      "authors": [
        "K Hemming",
        "J Kasza",
        "R Hooper"
      ],
      "year": 2020
    },
    {
      "title": "A maximum likelihood approach to power calculations for stepped wedge designs of binary outcomes",
      "authors": [
        "X Zhou",
        "X Liao",
        "L Kunz"
      ],
      "year": 2020,
      "doi": "10.1093/biostatistics/kxy031"
    },
    {
      "title": "An integrated population-averaged approach to the design, analysis and sample size determination of cluster-unit trials",
      "authors": [
        "J Preisser",
        "M Young",
        "D Zaccaro"
      ],
      "year": 2003,
      "doi": "10.1002/sim.1379"
    },
    {
      "title": "Time parameterizations in cluster randomized trial planning",
      "authors": [
        "K Grantham",
        "A Forbes",
        "S Heritier"
      ],
      "year": 2020,
      "doi": "10.1080/00031305.2019.1623072"
    },
    {
      "title": "PASS 2021 Power Analysis and Sample Size Software",
      "year": 2021,
      "doi": "10.1177/089443939201000319"
    },
    {
      "title": "Statsols. nQuery Sample Size and Power Calculation",
      "year": 2021
    },
    {
      "title": "swdpwr: A SAS macro and an R package for power calculations in stepped wedge cluster randomized trials",
      "authors": [
        "J Chen",
        "X Zhou",
        "F Li"
      ],
      "year": 2022,
      "doi": "10.1016/j.cmpb.2021.106522"
    },
    {
      "title": "swCRTdesign: an RPackage for stepped wedge trial design and analysis",
      "authors": [
        "E Voldal",
        "N Hakhu",
        "F Xia"
      ],
      "year": 2020
    },
    {
      "title": "Power and sample size calculation for stepped-wedge designs with discrete outcomes",
      "authors": [
        "F Xia",
        "J Hughes",
        "E Voldal"
      ],
      "year": 2021,
      "doi": "10.1186/s13063-021-05542-9"
    },
    {
      "title": "Preisser-Software",
      "authors": [
        "J Preisser",
        "S John"
      ],
      "year": 2021
    },
    {
      "title": "%CRTFASTGEEPWR: a SAS macro for power of the generalized estimating equations of multi-period cluster randomized trials with application to stepped wedge designs",
      "authors": [
        "Y Zhang",
        "J Preisser",
        "F Li",
        "E Turner",
        "P Rathouz"
      ],
      "year": 2022
    },
    {
      "authors": [
        "Packages-John Stata",
        "Gallis"
      ],
      "year": 2021
    },
    {
      "title": "Sample size considerations for stepped wedge designs with subclusters",
      "authors": [
        "K Davis-Plourde",
        "M Taljaard",
        "F Li"
      ],
      "year": 2021,
      "doi": "10.1111/biom.13596"
    },
    {
      "title": "CRTpowerdist: An R package to calculate attained power and construct the power distribution for cross-sectional stepped-wedge and parallel cluster randomized trials",
      "authors": [
        "Y Ouyang",
        "L Xu",
        "M Karim"
      ],
      "year": 2021,
      "doi": "10.1016/j.cmpb.2021.106255"
    },
    {
      "title": "Explaining the variation in the attained power of a stepped-wedge trial with unequal cluster sizes",
      "authors": [
        "Y Ouyang",
        "M Karim",
        "P Gustafson"
      ],
      "year": 2020,
      "doi": "10.1186/s12874-020-01036-5"
    },
    {
      "title": "SteppedPower: Power Calculation for Stepped Wedge Designs",
      "authors": [
        "P Mildenberger",
        "F Marini"
      ],
      "year": 2021,
      "doi": "10.32614/cran.package.steppedpower"
    },
    {
      "title": "Pragmatic, randomized controlled trials of the Girls on the Go! Program to improve self-esteem in girls",
      "authors": [
        "L Tirlea",
        "H Truby",
        "T Haines"
      ],
      "year": 2016
    },
    {
      "title": "Uptake and populationlevel impact of expedited partner therapy (EPT) on Chlamydia trachomatis and Neisseria gonorrhoeae: the Washington State Community-Level Randomized Trial of EPT",
      "authors": [
        "M Golden",
        "R Kerani",
        "M Stenger"
      ],
      "year": 2015,
      "doi": "10.1371/journal.pmed.1001777"
    },
    {
      "title": "Intra-cluster correlations from the CLustered OUtcome Dataset bank to inform the design of longitudinal cluster trials",
      "authors": [
        "E Korevaar",
        "J Kasza",
        "M Taljaard"
      ],
      "year": 2021,
      "doi": "10.1177/17407745211020852"
    },
    {
      "title": "Impact of unequal cluster sizes for GEE analyses of stepped wedge cluster randomized trials with binary outcomes",
      "authors": [
        "Z Tian",
        "J Preisser",
        "D Esserman"
      ],
      "year": 2022
    },
    {
      "title": "Marginal modeling of clusterperiod means and intraclass correlations in stepped wedge designs with binary outcomes",
      "authors": [
        "F Li",
        "H Yu",
        "P Rathouz"
      ],
      "year": 2021,
      "doi": "10.1093/biostatistics/kxaa056"
    },
    {
      "title": "Inference for the treatment effect in multiple-period cluster randomised trials when random effect correlation structure is misspecified",
      "authors": [
        "J Kasza",
        "A Forbes"
      ],
      "year": 2019,
      "doi": "10.1177/0962280218797151"
    },
    {
      "title": "Use of information criteria for selecting a correlation structure for longitudinal cluster randomised trials",
      "authors": [
        "E Rezaei-Darzi",
        "J Kasza",
        "A Forbes"
      ],
      "doi": "10.1177/17407745221082227"
    }
  ],
  "num_references": 49
}
