{
  "paper_id": "GL3JHEUB",
  "title": "Comparison of small-sample standard-error corrections for generalised estimating equations in stepped wedge cluster randomised trials with a binary outcome: A simulation study",
  "abstract": "Generalised estimating equations with the sandwich standard-error estimator provide a promising method of analysis for stepped wedge cluster randomised trials. However, they have inflated type-one error when used with a small number of clusters, which is common for stepped wedge cluster randomised trials. We present a large simulation study of binary outcomes comparing bias-corrected standard errors from Fay and Graubard; Mancl and DeRouen; Kauermann and Carroll; Morel, Bokossa, and Neerchal; and Mackinnon and White with an independent and exchangeable working correlation matrix. We constructed 95% confidence intervals using a t-distribution with degrees of freedom including clusters minus parameters (DF C-P ), cluster periods minus parameters, and estimators from Fay and Graubard (DF FG ), and Pan and Wall. Fay and Graubard and an approximation to Kauermann and Carroll (with simpler matrix inversion) were unbiased in a wide range of scenarios with an independent working correlation matrix and more than 12 clusters. They gave confidence intervals with close to 95% coverage with DF FG with 12 or more clusters, and DF C-P with 18 or more clusters. Both standard errors were conservative with fewer clusters. With an exchangeable working correlation matrix, approximated Kauermann and Carroll and Fay and Graubard had a small degree of under-coverage.",
  "year": 1986,
  "date": "1986",
  "journal": "Biometrika",
  "publication": "Biometrika",
  "authors": [
    {
      "forename": "Jennifer",
      "surname": "Thompson",
      "name": "Jennifer Thompson",
      "affiliation": "1  Department of Infectious Disease Epidemiology , London School of Hygiene & Tropical Medicine , London , UK \n\t\t\t\t\t\t\t\t Department of Infectious Disease Epidemiology \n\t\t\t\t\t\t\t\t London School of Hygiene & Tropical Medicine \n\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t\t London \n\t\t\t\t\t\t\t\t\t UK",
      "email": "jennifer.thompson@lshtm.ac.uk"
    },
    {
      "forename": "K",
      "surname": "Hemming",
      "name": "K Hemming",
      "affiliation": "2  Institute of Applied Health Research , University of Birmingham , Birmingham , UK \n\t\t\t\t\t\t\t\t Institute of Applied Health Research \n\t\t\t\t\t\t\t\t University of Birmingham \n\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t\t Birmingham \n\t\t\t\t\t\t\t\t\t UK",
      "orcid": "0000-0002-3068-3952"
    },
    {
      "forename": "A",
      "surname": "Forbes",
      "name": "A Forbes",
      "affiliation": "3  Biostatistics Unit , Monash University , Melbourne , Australia \n\t\t\t\t\t\t\t\t Biostatistics Unit \n\t\t\t\t\t\t\t\t Monash University \n\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t\t Melbourne \n\t\t\t\t\t\t\t\t\t Australia",
      "orcid": "0000-0002-2226-6550"
    },
    {
      "forename": "K",
      "surname": "Fielding",
      "name": "K Fielding",
      "affiliation": "1  Department of Infectious Disease Epidemiology , London School of Hygiene & Tropical Medicine , London , UK \n\t\t\t\t\t\t\t\t Department of Infectious Disease Epidemiology \n\t\t\t\t\t\t\t\t London School of Hygiene & Tropical Medicine \n\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t\t London \n\t\t\t\t\t\t\t\t\t UK"
    },
    {
      "forename": "R",
      "surname": "Hayes",
      "name": "R Hayes",
      "affiliation": "1  Department of Infectious Disease Epidemiology , London School of Hygiene & Tropical Medicine , London , UK \n\t\t\t\t\t\t\t\t Department of Infectious Disease Epidemiology \n\t\t\t\t\t\t\t\t London School of Hygiene & Tropical Medicine \n\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t\t London \n\t\t\t\t\t\t\t\t\t UK"
    },
    {
      "affiliation": "Faculty of Epidemiology and Population Health , London School of Hygiene and Tropical Medicine , Keppel Street , London WC1E 7HT , UK. \n\t\t\t\t\t\t\t\t Faculty of Epidemiology and Population Health \n\t\t\t\t\t\t\t\t London School of Hygiene and Tropical Medicine \n\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t\t Keppel Street \n\t\t\t\t\t\t\t\t\t WC1E 7HT \n\t\t\t\t\t\t\t\t\t London \n\t\t\t\t\t\t\t\t\t UK"
    }
  ],
  "doi": "https://doi.org/10.13039/501100000265",
  "keywords": [
    "Stepped wedge cluster randomised trials",
    "correlated data",
    "sandwich variance",
    "small sample corrections",
    "degrees of freedom",
    "generalised estimating equations"
  ],
  "sections": [
    {
      "title": "Introduction",
      "text": "Many small sample corrections are available for generalised estimating equations  1  (GEE) with the sandwich standard-error estimator,  [2] [3] [4] [5] [6] [7]  but there has been limited research on which are appropriate for use in stepped wedge trials (SW-CRTs) with a binary outcome.\n\nAn SW-CRT is a type of cluster randomised trial (CRT). Groups of individuals, known as clusters, are randomised to different sequences. The sequence dictates the time at which clusters will switch from a control condition to receive the intervention (Figure  1 ). In practice, SW-CRTS often collect binary outcomes and randomise a small number of clusters: a recent systematic review indicated that 75% of trials randomised 23 or fewer clusters.  8 nalysis of SW-CRTs requires consideration of the correlation between observations in each cluster. The strength of correlation may depend on the timing of observations within clusters, for example correlation can be stronger between observations from the same cluster collected closer together in time. 9 GEE, which estimate population average effects, together with the sandwich standard-error estimator account for this correlation and are asymptotically robust to misspecification of correlation structures.  1, 10 This is useful in a trial setting, where analysis methods must be prespecified often with little information to guide the choice of correlation structure.\n\nWith a small number of clusters, the standard-error estimates from GEE with sandwich standard-errors are biased, and the variability in the estimated standard errors means than confidence intervals are too narrow when constructed using a normal distribution.  11 A rule of thumb for parallel CRTs is that 40 clusters are required to avoid these issues,  12  and this limits the utility of GEE for CRTs.\n\nMany corrections have been developed to improve estimation of sandwich standard-errors in finite samples,  [2] [3] [4] [5] 7  and confidence intervals can be estimated using a t-distribution rather than a normal distribution to allow for the standard-error variability; several suggestions for the degrees of freedom (DF) have been published.  3, 6  The performance of these corrections is an area of active research in the context of longitudinal data,  13, 14  parallel CRTs,  15, 16  and SW-CRTs,  17, 18  and many of these papers have shown that GEE can be used with as few as 10 clusters using these corrections. However, research gaps remain for SW-CRTs, such as performance of the corrections with a binary outcome and varying cluster size.\n\nIn this paper, we begin by reviewing the literature studying several of the corrections suitable for SW-CRTs. We report the results of an extensive simulation study comparing the performance of these standard-error corrections and several DF estimators in the context of SW-CRTs with a binary outcome. We also assess whether GEE are robust to misspecification of the working correlation structure in this context. We provide guidance on which are suitable methods in this setting and demonstrate use of the methods under study in an illustrative example."
    },
    {
      "title": "Generalised estimating equations with small-sample correction",
      "text": "There have been several corrections published to improve the performance of GEE with sandwich standard errors in small samples. In this paper we consider the following standard-error corrections and the use of a t-distribution. Details of these methods are given in Supplementary text 1."
    },
    {
      "title": "Sandwich standard-error corrections",
      "text": "We consider several modifications that aim to reduce bias in the sandwich standard errors:\n\n\u2022 Kauermann and Carroll (KC)  4  \u2022 Fay and Graubard (FG)  3  \u2022 Mancl and DeRouen (MD)  5  \u2022 Morel, Bokossa, and Neerchal (MBN)  7  \u2022 Mackinnon and White (MW)  2  Some additional corrections were excluded because of computational complexity with varying cluster size that will limit their utility in CRTs.  6, 14, 19, 20"
    },
    {
      "title": "Degree-of-freedom corrections",
      "text": "In smaller samples, as well as correcting the standard-error estimator, p-values and confidence intervals may need to utilise the t-distribution to account for variability in the standard error estimation.\n\nWe consider the following estimators for t-distribution degrees of freedom (DF):\n\n\u2022 Satterthwaite-type DF accounts explicitly for variability in the standard-error estimator. We consider estimators from Pan and Wall (DF PW )  21  and Fay and Graubard (DF FG ).  3  \u2022 Simpler estimators for the DF can be derived from the trial design. A common option is to use clusters minus parameters (DF C-P ). Further trial design DF considered in this paper are described in section 4."
    },
    {
      "title": "Literature review",
      "text": "The simplest correction, MW, has been found to give good standard error bias correction with a common cluster size in CRT and longitudinal data settings, leading to well-controlled type-one error when combined with DF C-P .  15, 22 However, it has not been studied in the SW-CRT setting. The performance is similar regardless of working correlation matrix.  13 C has been found to give standard errors with little bias in longitudinal data settings,  14  CRTs,  23  and SW-CRTS.  17 Type-one error and confidence interval coverage have been well maintained with DF C-P , including variable cluster size with a coefficient of variation up to 0.6.  15, 18 Type-one error has often been inflated with the use of DF  Inf 13, 15, 17, 23  and DF PW,  13  but type-one error has sometimes been maintained with DF Inf with common cluster size.  24 Performance is similar regardless of working correlation matrix.  13, 17 We also identified variation in the expression  17  and implementation  [25] [26] [27]  of this correction, with approximations being used by some.  14, 28 cott et al. show that FG is a simplification of KC.  17  The performance of FG has been less clear. FG has been shown to give standard errors with low bias for SW-CRTs,  17  but to overcorrect standard errors in a longitudinal setting with small cluster size.  14 For SW-CRTs, type-one error and confidence interval coverage have been well maintained with DF C-P and DF FG .  17, 18 For CRTs, type-one error and confidence interval coverage have been well maintained with DF Inf  24  and DF C-P ,  15  but conservative with DF FG .  16 For longitudinal data, DF PW and DF Inf have both resulted in inflated type-one error.  13 Performance is similar regardless of working correlation matrix.  13, 17 D has consistently been found to over correct the standard errors in longitudinal data,  19, 29  CRTs,  23, 30  and SW-CRTs.  17 Generally, p-values and confidence intervals constructed with DF Inf  15, 17, 18, 23, 24, 30  and DF PW 13,14,30   have had close to the correct size, although there have been exceptions to this.  13  Conservative type-one error and confidence intervals have been observed with DF C-P .  15, 18, 30 Performance may be improved with use of an independent working correlation matrix.  19 BN has been found to overcorrect standard errors for SW-CRTS.  17 Type-one error remained inflated and confidence interval coverage remained low with DF Inf .  13, 17, 24, 31 Other DF have led to conservative type-one error in longitudinal settings.  13, 14 In the CRT settings, Li and Redden 15 found that DF C-P gave conservative type-one error with common cluster size, and inflated type-one error with varying cluster size. Performance is similar regardless of working correlation matrix.  13, 17"
    },
    {
      "title": "Simulation study methods",
      "text": "We conducted a simulation study to compare these small sample corrections. Simulation study parameters were selected to represent the most common characteristics of SW-CRTs, based on several recent reviews.  8, 32, 33 cenarios simulated are summarised in Table  1  and further details are given in Supplementary Text 2. Simulations were conducted in R v3.5.  34 ll combinations of parameters were generated unless otherwise stated, and we simulated 1000 datasets for each scenario. This gave 95% probability of estimating confidence-interval coverage between 93.6% and 96.4% when there is true 95% coverage.\n\nThe simulations were conducted in two phases. Phase one included 64 scenarios with 18 clusters to identify the small-sample corrections that gave good coverage in the widest range of scenarios. Phase two involved a wider range of 690 scenarios with a smaller number of small sample corrections chosen based on the results of phase one."
    },
    {
      "title": "Data generation process"
    },
    {
      "title": "Method used to generate binary data",
      "text": "In order to simulate binary data specifying the marginal effects, we used the method of Emrich and Piedmonte.  35 bservations are sampled from a multivariate-normal distribution with zero means. The covariance matrix for the multivariate-normal distribution is determined using an algorithm, so that the dichotomised data will have the desired correlation structure on the proportion scale. The sampled values are dichotomised at values that give the required marginal probabilities."
    },
    {
      "title": "Prevalence and intervention effects",
      "text": "We simulated a repeated cross-sectional design with data collected at six measurement occasions. Individuals were each observed once and different individuals were observed in each measurement occasion. We simulated an outcome prevalence of 30% (odds \u00bc 0.43) in the control condition in the first measurement occasion. This increased with a linear (on the log scale) trend with OR \u00bc 1.05 at each measurement occasion, so that by the sixth occasion, the outcome prevalence in the control condition would have been 37% (odds \u00bc 0.43 \u00c2 1.05 5 \u00bc 0.55). This did not change with the trial design to facilitate comparability of the underlying data. The intervention effect had OR \u00bc 1.3. These characteristics were the same in both phases of the simulations."
    },
    {
      "title": "Correlation structures",
      "text": "In phase one of the simulations, we simulated data with either a high (0.1), or low (0.01) intracluster correlation coefficient (ICC) within each measurement occasion on the proportion scale (q in Supplementary Text 2). For phase two, we introduced an additional medium (0.05) ICC. The correlation structures were the same in both phases of the simulations. Within each cluster and measurement occasion, observations were exchangeable on the proportions scale. We simulated four within-cluster correlation structures to vary the correlation between the six measurement occasions:\n\n\u2022 Exchangeable: All observations within a cluster were equally correlated to one another.\n\n\u2022 Autoregressive (AR(1)) with autoregressive parameter r 0 \u00bc0.6: The correlation between observations in the same cluster but different measurement occasions reduced by 40% with each successive occasion. \u2022 AR(1) r 0 \u00bc0.8: The correlation between observations in the same cluster but different measurement occasions reduced by 20% with each successive occasion. \u2022 AR(1) r 0 \u00bc0.8 \u00fe 50% reduction in correlation between control and intervention observations: The correlation between observations in the same cluster reduced by 20% with each successive measurement occasion, and there is an additional 50% reduction in correlation between observations where one is in the control condition and the other the intervention condition. This could occur if the intervention effect varied between clusters."
    },
    {
      "title": "Trial designs",
      "text": "In both phases, we simulated data from SW-CRT designs with either three or six sequences, as shown in Figure  1 .\n\nIn both designs, there was no period with all clusters in the control as inclusion of this period is inefficient.  36, 37 In the design with six sequences, the trial periods coincided with the measurement occasions. In the design with three sequences, each trial period contained two measurement occasions.\n\nIn phase one, we simulated trials with 18 clusters. In phase two, we simulated trials with 6, 12, 18, 24, 42, 48, and 54 clusters; this allowed us to explore the performance of the corrections with a range of small trials and explore the behaviour of uncorrected GEE for larger trials.\n\nIn both phases, we simulated trials with common and varying (coefficient of variation (CV) \u00bc 0.4) cluster size. Varying cluster size was sampled from a negative binomial distribution with the required mean and standard deviation so that each measurement occasion had a minimum of two observations for each cluster. In phase one, we simulated clusters with 24 or 60 observations per cluster; where clusters varied in size, this was the mean. A cluster size of 24 corresponds to four observations in each measurement occasion, and a cluster size of 60 corresponds to 10 observations in each measurement occasion. In phase two, we introduced a limited number of scenarios with 300 observations per cluster (50 observations per measurement occasion). To maintain a feasible computational time, this scenario was only introduced with common cluster size, exchangeable correlations, and 12, 24, or 42 clusters."
    },
    {
      "title": "Analysis methods",
      "text": "All datasets were analysed at the individual level using GEE with sandwich standard errors with both an independent and exchangeable working correlation matrix using the R package geepack  38  . The GEE used a binomial distribution with logistic link. The models included an intervention effect and a period effect, with a category for each trial period.\n\nIn phase one, all corrected sandwich estimators described in section 2.1 were calculated using the R package geesmv  25  with default values for boundary and adjustment values where relevant. For the two standard error corrections that consistently gave the least biased standard errors, confidence intervals were created using a normal distribution and t-distribution with the following DF:\n\n\u2022 Pan and Wall (DF PW )  21  : calculated by the R package geesmv V1.3.\n\n\u2022 Fay and Graubard (DF FG )  3  : calculated by the R package saws V0.9-6.1.\n\n\u2022 Clusters minus parameters (DF C-P ): With the trial designs we used, the number of parameters is number of sequences \u00fe 1. In scenarios with one cluster randomised to each sequence, this will give a negative result, which we replaced with 1 DF. \u2022 Cluster periods minus parameters (DF CP-P ): Uses cluster periods as the observation unit, and parameters are as above.\n\n\u2022 Cluster periods minus parameters with clusters regarded as additional parameters (DF CP-C-P ): This is based on an ANOVA-style decomposition with clusters as parameters.\n\nThe two selected standard errors and two DF that resulted in confidence interval coverage nearest to the 95% level were carried forward from phase one to phase two."
    },
    {
      "title": "4.1.6",
      "text": "Post-hoc analysis method. Our simulation study identified problems with the stability of the KC standard error from the geesmv package. To address this problem, we repeated the simulation using an approximation to the KC correction (KC-approx) suggested by Gallis et al.  28  and implemented in xtgeebcv in Stata. More details are given in Supplementary text 1."
    },
    {
      "title": "Analysis of simulation results",
      "text": "We calculated convergence proportions, standardised bias of intervention effect estimates, and the relative error of standard errors ([mean estimated standard error]/[standard deviation of the intervention effect estimates across simulations] \u00c0 1). We calculated the mean and standard deviation of DF PW and DF FG ; other DF were determined by the trial design.\n\nWe refer to 95% confidence interval coverage (the proportion of results with 95% confidence intervals that contained the true effect) below 93.6% as low coverage or under covered, and coverage above 96.4% as high coverage or over covered. Power was calculated as the proportion of datasets with p < 0.05 against the null hypothesis of no intervention effect.\n\nWe used linear regression models to quantify the association between simulation scenario characteristics and analysis method performance measures such as bias and coverage."
    },
    {
      "title": "Simulation study results"
    },
    {
      "title": "Phase one",
      "text": "Few analyses failed to converge (<4% in any scenario), and the intervention effect estimate bias was small in all scenarios ( 10% standardised bias in any scenario, Supplementary Table  1  and Supplementary Figure  1 )."
    },
    {
      "title": "Standard error bias",
      "text": "Figure  2  shows histograms of the relative error of standard errors in each scenario. Uncorrected standard errors were underestimated by an average of 9% and 10% with a working independent and exchangeable correlation matrix, respectively. All corrections gave standard errors closer to the empirical standard deviation. Overall, KC and FG gave the most accurate standard errors and were the two corrections carried forward in the simulations. Below, we provide details of the performance of each correction and Supplementary Table  2  shows regression analyses for each correction.\n\nKauermann and Carroll: With an independent working correlation matrix, KC standard errors were always within 10% of the empirical standard deviation. With an exchangeable working correlation matrix, KC were on average unbiased, but became more variable: KC overcorrected standard errors by >10% in 13/64 (20%) scenarios: this occurred mostly (11/13) with exchangeable or AR(1) r \u00bc 0.8 correlations, so that the correlation structure was correctly or close to correctly specified, (Supplementary Figure  2 ) and with ICC \u00bc 0.1 (Supplementary Figure  3 ). Bias was similar for scenarios with common and varying cluster size (Supplementary Table  2 ).\n\nFay and Graubard: With an independent working correlation matrix, the FG standard errors were within 10% of the empirical standard deviation in all scenarios. With an exchangeable working correlation matrix, standard errors were undercorrected with ICC \u00bc 0.1 but close to empirical values with ICC \u00bc 0.01 (mean\u00bc\u00c01% ICC \u00bc 0.01 vs. \u00c05% ICC \u00bc 0.1, Supplementary Figure  3 ).\n\nMancl and DeRouen: MD standard errors overcorrected by on average 6%. Over correction was greater when cluster size varied (8% CV \u00bc 0.4 vs. 5% CV \u00bc 0, Supplementary Figure  4 ) and with low ICC (8% ICC \u00bc 0.01 vs. 5% ICC \u00bc 0.1, Supplementary Figure  3 ).\n\nMorel, Bokossa, and Neerchal: MBN standard errors overcorrected by on average 6% with three sequences and 13% with six sequences (Supplementary Figure  5 ). Bias was on average 3% larger for common cluster size than varying cluster size (Supplementary Table  2 ).\n\nMackinnon and White: MW standard errors followed a similar trend to MBN standard errors, over correcting on average 3% with three sequences and 16% with six sequences (Supplementary Figure  5 ). Bias was on average 4% larger for common cluster size than varying cluster size (Supplementary Table  2 )."
    },
    {
      "title": "Degrees of freedom",
      "text": "Table  2  summarises estimated DF with FG standard errors and an independent working correlation matrix. Results were similar with different analysis methods. Supplementary Table  3  shows factors associated with larger DF.\n\nDF FG were of similar magnitude to DF C-P . There was little variability within scenarios (mean standard deviation (SD)\u00bc1.2).\n\nDF PW were larger than DF FG and had large variability within scenarios (mean SD \u00bc 61.8)."
    },
    {
      "title": "Coverage of 95% confidence intervals",
      "text": "Figure  3  shows histograms of 95% confidence interval coverage for KC and FG standard errors by working correlation matrix and DF. With both FG and KC standard errors, coverage was consistently closer to 95% using a t-distribution with either DF C-P or DF FG than other DF (Supplementary Table  4 ). These four analysis methods were continued forward to phase two. Other DF resulted in low coverage.\n\nWith an independent working correlation matrix, FG and KC standard errors gave consistent coverage with both DF C-P and DF FG . With an exchangeable working correlation matrix, coverage largely followed the patterns of bias in standard errors. KC standard errors had variable coverage due to over correction of standard errors in some scenarios: this was unaffected by choice of DF. FG standard errors had good coverage with low ICC and either DF (mean coverage 95.1% and 94.8% with DF FG and DF C-P respectively), but a small degree of under coverage with high ICC and either DF due to undercorrection of standard errors (94.3% and 94.5% with DF FG and DF C-P , respectively)."
    },
    {
      "title": "Phase two",
      "text": "In phase two, we widened the range of scenarios to include between 6 and 54 clusters, and a larger cluster size of 300, and only considered KC and FG standard errors with DF C-P and DF FG . Similar to phase one, nonconvergence was uncommon: <5% failed to converge in any scenario. There was no indication of intervention effect estimate bias in any scenario ( 11% standardised bias, Supplementary Table  5  and Supplementary Figure  6 )."
    },
    {
      "title": "Standard error bias",
      "text": "Figure  4  shows relative error of KC and FG standard errors (also see Supplementary Table  6 ). Kauermann and Carroll: With an independent working correlation matrix, KC standard errors remained unbiased with as few as six clusters. There was a small increase in the variability of estimates with fewer clusters. With an exchangeable working correlation matrix, the variability of KC standard errors increased with fewer clusters (Figure  4 ). The over-correction with an exchangeable working correlation matrix and a true exchangeable correlation structure became more severe with a cluster size of 300 (mean 91% relative error). Note: All calculated with Fay and Graubard standard errors and an independent working correlation matrix.\n\nFay and Graubard: With an independent working correlation matrix, FG standard errors had minimal bias with 12 clusters, but were on average 4% larger than the standard deviation of the intervention effect estimates with six clusters. With an exchangeable working correlation matrix, they became more variable with fewer clusters. The under correction with ICC \u00bc 0.1 became more severe with fewer clusters (mean \u00bc \u00c07% with 12 clusters and \u00c012% with 6 clusters), and overcorrection was seen with ICC \u00bc 0.01 (mean \u00bc 2% with 12 clusters and 13% with 6 clusters, Supplementary Figures 7).\n\nUncorrected: Bias of uncorrected sandwich standard errors increased with fewer clusters, but some remained with as many as 54 clusters: they were on average 14% smaller than the standard deviation of the intervention effect estimates with 12 clusters and 3% smaller with 54 clusters (Supplementary Figure  8 )."
    },
    {
      "title": "Degrees of freedom",
      "text": "With six clusters, DF FG was on average two DF larger than DF C-P . As the number of clusters increased, the difference reversed direction (Supplementary Figure  9 ): with 42 clusters, DF FG was on average four DF smaller than DF C-P ."
    },
    {
      "title": "Coverage of 95% confidence intervals",
      "text": "Coverage was consistently close to 95% with DF FG , an independent working correlation matrix, and either standard error (Figure  5  and Supplementary Table  7 ). DF C-P also performed well with 18 or more clusters with six sequences, and 12 or more clusters with three sequences.\n\nWith an exchangeable working correlation matrix, KC standard errors gave variable but conservative coverage: Only 9/690 (1%) scenarios had low coverage with DF FG . With FG standard errors, under correction of standard errors consistently resulted in coverage slightly less than 95%: 54/690 (8%) scenarios had low coverage with DF FG . The uncorrected GEE gave confidence intervals with low coverage in all scenarios with 24 or fewer clusters (Supplementary Figure  10 ). With 54 clusters, confidence intervals based on a normal distribution had low coverage in 84/192(44%) scenarios and coverage remained low using DF C-P (32/192[26%]) or DF FG (21/192[11%])."
    },
    {
      "title": "Power",
      "text": "With an independent working correlation matrix, KC and FG standard errors led to similar power (median 0.5% more power with KC IQR 0% to 0.9%, Supplementary Figure  11 ). DF C-P led to median 4% lower power than DF FG with six clusters, 1% lower with 12 clusters, and similar power with 18 or more clusters (Supplementary Figure  12 ).\n\nWith KC standard errors and DF FG , an exchangeable working correlation matrix led to similar power to an independent working correlation matrix (median 0.4% more power with an independent working correlation matrix, IQR -1.3% to 0.4%, Supplementary Figure  13 ).\n\nWith FG standard errors and DF FG , an exchangeable working correlation matrix led to an average 1.8% higher power than an independent working correlation matrix with 24 observations per cluster, 5.2% higher with 60 observations per cluster, but 39.6% higher power with 300 observations per cluster (Supplementary Figure  13 )."
    },
    {
      "title": "Post-hoc KC approximation",
      "text": "With an independent working correlation matrix, KC-approx was similar to KC and showed minimal bias with as few as six clusters (Supplementary Figure  14 ). This lead to confidence intervals with close to 95% coverage with 12 or more clusters and over coverage with six clusters with either DF FG or DF CMP .\n\nWith an exchangeable working correlation matrix, KC-approx standard errors had similar performance to FG standard errors, and did not suffer from the overcorrection seen with KC standard errors (Supplementary Figure  14 ). Standard errors showed little bias with 42 or more clusters, but were undercorrected with 24 or fewer clusters, with the degree of undercorrection increasing with fewer clusters (mean under correction \u00bc 2% with 24 clusters and 10% with 6 clusters). Despite this, confidence interval coverage was close to nominal levels when the correlation structure was correctly specified (4/186 [2%] scenarios had under covered confidence intervals with DF FG ). However, confidence interval coverage was slightly low in scenarios with reduced correlation between control and intervention observations (13/168 [8%] scenario with low coverage, Supplementary Figures  15  and  16 ). Power followed similar patterns to FG with small increase in power using an exchangeable working correlation structure with 24 and 60 observations per cluster (mean 1.5% and 4.0% higher), but larger differences with 300 observations per cluster (mean 37.0% higher)."
    },
    {
      "title": "Illustrative example",
      "text": "To explore the impact of choice of analysis, we will look at an example trial analysed with each method investigated in this study. Trajman et al.  39  conducted a trial comparing a new TB diagnostic test Xpert MTB/RIF to the commonly used smear microscopy test. We will focus on the impact of the type of test on the proportion of cases with a laboratory confirmation of diagnosis, which was a secondary outcome of the trial. This is an example of a continuous recruitment design with individuals sampled throughout the trial and one outcome collected from each.  40 The trial randomised 14 laboratories (clusters) into seven sequences. In the first month of the trial, all laboratories were using smear microscopy. Then each month, two laboratories switched to using the new tests, so that all laboratories were using the new diagnostic test in the eighth month of the trial. There were a total of 3924 observations, with a mean of 136 observations per cluster and CV in cluster size of 0.48.\n\nTable  3  shows the results of this trial analysed with all GEE analyses considered in this simulation study. Each model included a categorical variable for month to adjust for time and a variable for intervention status.\n\nStandard error inflation by the small sample corrections reflected the results of the simulation study. FG standard errors with an exchangeable working correlation matrix gave the smallest correction (7% inflation of the uncorrected standard errors). The largest correction was by the KC standard errors with an exchangeable working correlation matrix (75% inflation of the uncorrected standard errors) demonstrating the overcorrection of standard errors observed in the simulation study. The KC approximation gave a smaller inflation (14% increase from the uncorrected standard errors). MW standard errors were also large compared to the other corrected standard errors.\n\nThe most conservative DF are given DF C-P (DF C-P \u00bc5). Consistent with the simulation study, DF FG were slightly larger (DF FG \u00bc7.6 with an independent and 10.5 with an exchangeable working correlation matrix). All other DFs were larger; most were over 70.\n\nTable  3  also shows confidence intervals and p-values with the methods found to work consistently well by the simulation study (FG and KC-approx standard errors, with DF FG and DF C-P ) and with no small-sample correction. The uncorrected analyses conclude that there is strong evidence that the new test increased the odds of a confirmed diagnosis (p \u00bc 0.003 and p < 0.001 with an independent and exchangeable working correlation matrix, respectively). With an independent working correlation matrix, all corrected methods lead to similar conclusions (0.03 p 0.06) with confidence intervals with a similar width. With an exchangeable working correlation matrix, all methods led to some evidence of an effect, DF FG leading to greater evidence (p \u00bc 0.02 with DF C-P and p \u00bc 0.007 for FG and p \u00bc 0.009 for KC-approx with DF FG ) ."
    },
    {
      "title": "Discussion",
      "text": "We found that, with as many as 54 clusters, uncorrected sandwich standard errors were smaller than the standard deviation of the intervention effect estimates across simulations leading to lower than nominal 95% confidence interval coverage. KC and FG standard errors performed well to mitigate this bias when used with an independent working correlation matrix, and results were robust to misspecification of the working correlation matrix. Use of a t-distribution with DF FG gave consistently good confidence interval coverage with at least 12 clusters, and DF C-P gave similar results with at least 18 clusters. Both DF became conservative with fewer clusters. Interpretation of results with an exchangeable working correlation matrix is less clear. KC standard errors required use of an approximation. A small amount of bias remained with FG standard errors leading to coverage less than 95%. An exchangeable working correlation matrix gave higher power than an independent working correlation matrix with 300 observations per cluster, but similar power with smaller clusters.\n\nWe found that KC standard errors were unbiased when used with an independent working correlation matrix with cluster size from 24 to 300, CV of cluster size 0 to 0.4, ICC from 0.01 to 0.1, across different true correlation structures, with 3 or 6 sequences, and with as few as 12 clusters. These findings are consistent with previous research that reported good overall performance.  13, [16] [17] [18] 18] 24  With an exchangeable working correlation matrix, we found that KC were highly variable in some scenarios due to instability in the matrix inversion required by this correction.  14, 28 The approximation we tested, also used in xtgeebcv in Stata,  28  corrected this instability, with a small cost to bias correction: similar to the FG standard errors, a small bias remained with 24 clusters or fewer. Other CRT and SW-CRT simulations have not encountered the problem of instability with similar cluster size and ICC without describing the use of alternative calculations,  18, 23  although this could be due to differences in implementation that have not been reported. Our results highlight the importance of the implementation of this correction. Other solutions to the complex inversion such as singular value decomposition (used by the SAS glimmix procedure  26  ) may have better performance than the methods we explored.\n\nWe found that FG standard errors were unbiased with an independent working correlation matrix with cluster size from 24 to 300, CV of cluster size from 0 to 0.4, ICC from 0.01 to 0.1, across different true correlation structures, with three or six sequences, and with as few as 12 clusters. We observed a small bias in standard errors when used with an exchangeable working correlation matrix leading to a small degree of under coverage of confidence intervals. Previous studies have concluded that FG standard errors perform well in similar scenarios.  13, [16] [17] [18] 18] 24  The small size of this bias and impact on confidence interval coverage is likely why the under correction has not previously been reported. Consistent with our findings, Scott et al. and Leyrat et al. observed conservative confidence interval coverage and type-one error, respectively, with FG and DF FG and a very small number of clusters  16, 17  in SW-CRTs and CRT, respectively.\n\nOur finding that KC and FG provide more consistent standard error estimates with an independent working correlation matrix is novel in the literature. We also found that this had limited impact on power for KC with any cluster size, and FG with median to small cluster size, but a large impact on power for FG with large clusters. The KC findings are contrary to the literature on GEE with sandwich standard errors that suggest power will be higher the closer the working correlation structure is to the true correlation structure.  41 These comparisons of power should be viewed with some caution, as some of the difference will be mediated by the bias in standard errors with an exchangeable working correlation matrix. The drawback to assuming independence is that a separate analysis is required to estimate the correlation parameters, which CONSORT guidelines recommend reporting.  42 vercorrection of MD, MW, and MBN standard errors has also been reported elsewhere.  15, 17, 23, 24 Where others have found appropriate type-one error and confidence interval coverage using MD, this may be explained by the choice of DF  Inf 15, 17, 18, 23, 24, 30  and DF PW .  13, 14, 30 Our findings do not support the use of an average of KC and MD standard errors as suggested by others 14 : our results imply that this would result in standard errors that are too large. For MBN and MW standard errors, contrary to findings for parallel CRTs,  15, 22, 24  we observed overcorrection with common cluster size as well as varying cluster size, and moreover, the bias was larger with common cluster size.\n\nWe have also given a detailed comparison of the performance of DF FG and DF PW in comparison to simpler estimators based on the trial design.\n\nDF PW performed poorly: we found large variability in the estimates, a property that has not been examined in other simulation studies that have included this method.  6, 43 F FG gave less variable estimates than DF PW and provided the most robust confidence interval coverage of the DF we considered. Others have also found that this method performs well. 3, 17  We found that DF FG were similar to DF C-P with 18 or more clusters and so lead to similar coverage. With fewer than 18 clusters, DF FG was larger than DF C-P and had closer to 95% coverage. Other than by number of clusters, the difference in performance varied little between the scenarios we considered including common and varying cluster size."
    },
    {
      "title": "Strengths and limitations",
      "text": "The strengths of this study are in the comprehensive range of scenarios considered (nearly 700 in phase two), the wide range of small sample corrections included, and the use of methods that generate correlated data from marginal effects.\n\nThere are several corrections that we did not consider, which may have superior performance to the corrections we used.  6, 14, 19, 20 However, software availability for varying cluster size currently limits the utility of these additional corrections for CRTs. Our approach has been to identify methods that performed well across a broad range of scenarios; an alternative correction may have better performance in a particular scenario than those we have concluded were robust overall. We only considered a common outcome, and we have focused on a binary outcome, where GEE estimate marginal, or population average, effects: researchers should consider whether this is the effect of interest in their setting.  44 Our simulation study used an SW-CRT design with no baseline period. However, our results are consistent with other simulation studies that included a baseline period.  17, 18 The working correlation structures we considered (exchangeable and independent) did not incorporate the timing of observations within clusters. We have shown that this did not affect the confidence interval coverage, but as is typically the case with GEE, power may be improved by choosing a working correlation matrix that more closely follows the true structure. For example, the working correlation matrix could allow correlation to decay with distance between observation periods.  45"
    },
    {
      "title": "Concluding remarks",
      "text": "We have shown that GEE with small sample corrections are a robust method of analysis in a range of settings where SW-CRTs are commonly used. When there are fewer than 50 clusters, we recommend the use of KC, KCapprox, or FG standard errors with an independent working correlation structure, KC-approx standard errors with an exchangeable working correlation structure if clusters are large, or FG standard errors with an exchangeable working correlation structure if clusters are large and ICC is low. A t-distribution is also required with DF FG , although DF C-P is sufficient for trials with 18 or more clusters."
    },
    {
      "text": "Figure 1. Trial designs used in the simulation study. SW-CRTs with no baseline period and (a) three or (b) six sequences. Coloured cell \u00bc intervention, white cells \u00bc control."
    },
    {
      "text": "Figure 2. Phase one: Histogram of relative error of sandwich standard errors with each small sample correction (rows: Uncorrected (Uncorr), Kauermann and Carroll (KC), Fay and Graubard (FG), Mancl and DeRouen (MD), Morel, Bokossa, and Neerchal (MBN), and Mackinnon and White (MW)) for an independent and exchangeable working correlation matrix (columns). All scenarios have 18 clusters. Grey dotted lines indicate 0% error and AE10% error."
    },
    {
      "text": "Figure 3. Phase one: Histogram of 95% confidence interval coverage of Kauermann and Carroll (KC) and Fay and Graubard (FG) standard errors and each working correlation matrix (columns) with each t-distribution degree of freedom estimator (rows, infinite (Inf, a normal distribution), Fay and Graubard (FG), Pan and Wall (PW), clusters minus parameters (C-P), Cluster periods minus parameters (CP-P), Cluster periods minus clusters minus parameters (CP-C-P)). Grey dotted lines indicate 93.6%, 95%, and 96.4% coverage."
    },
    {
      "text": "Figure 4. Phase two: Histogram of relative error of sandwich standard errors with an independent or exchangeable working correlation matrix (columns) for Kauermann and Carroll (KC), and Fay and Graubard (FG) standard errors with either 6, 12, 18, 24, or 54 clusters (rows). Grey dotted lines indicate 0% error and AE10% error."
    },
    {
      "text": "Figure 5. Phase two: Histogram of 95% confidence interval coverage of Fay and Graubard (FG), and Kauermann and Carroll (KC) standard errors and each working correlation matrix (columns) with 6, 12, 24, or 48 clusters using DF FG and DF C-P (rows). Grey dotted lines indicate 93.6%, 95%, and 96.4% coverage."
    },
    {
      "text": "Summary of data generation scenarios, see Supplementary Text 2 for more details."
    },
    {
      "text": "Phase one: The mean of the within scenario mean and standard deviation (SD) of all degrees of freedom (DF) by number of sequences."
    },
    {
      "text": "Example TB diagnostic trial analysed with each GEE method. Fay and Graubard; KC: Kauermann and Carroll; MD: Mancl and DeRouen; MBN: Morel, Bokossa, and Neerchal; MW: Mackinnon and White; GEE: Generalised estimating equations."
    }
  ],
  "references": [
    {
      "title": "Longitudinal data-analysis using generalized linear-models",
      "authors": [
        "K Liang",
        "S Zeger"
      ],
      "year": 1986,
      "doi": "10.1093/biomet/73.1.13"
    },
    {
      "title": "Some heteroskedasticity-consistent covariance-matrix estimators with improved finitesample properties",
      "authors": [
        "J Mackinnon",
        "H White"
      ],
      "year": 1985,
      "doi": "10.1016/0304-4076(85)90158-7"
    },
    {
      "title": "Small-sample adjustments for Wald-type tests using sandwich estimators",
      "authors": [
        "M Fay",
        "B Graubard"
      ],
      "year": 2001,
      "doi": "10.1111/j.0006-341x.2001.01198.x"
    },
    {
      "title": "A note on the efficiency of sandwich covariance matrix estimation",
      "authors": [
        "G Kauermann",
        "R Carroll"
      ],
      "year": 2001
    },
    {
      "title": "A covariance estimator for GEE with improved small-sample properties",
      "authors": [
        "L Mancl",
        "T Derouen"
      ],
      "year": 2001,
      "doi": "10.1111/j.0006-341x.2001.00126.x"
    },
    {
      "title": "Small-sample adjustments in using the sandwich variance estimator in generalized estimating equations",
      "authors": [
        "W Pan",
        "M Wall"
      ],
      "year": 2002
    },
    {
      "title": "Small sample correction for the variance of GEE estimators",
      "authors": [
        "J Morel",
        "M Bokossa",
        "N Neerchal"
      ],
      "year": 2003,
      "doi": "10.1002/bimj.200390021"
    },
    {
      "title": "Unequal cluster sizes in stepped-wedge cluster randomised trials: a systematic review",
      "authors": [
        "C Kristunas",
        "Morris Gray"
      ],
      "year": 2017,
      "doi": "10.1136/bmjopen-2017-017151"
    },
    {
      "title": "Intra-cluster and inter-period correlation coefficients for cross-sectional cluster randomised controlled trials for type-2 diabetes in UK primary care",
      "authors": [
        "J Martin",
        "A Girling",
        "K Nirantharakumar"
      ],
      "year": 2016,
      "doi": "10.1186/s13063-016-1532-9"
    },
    {
      "title": "An integrated population-averaged approach to the design, analysis and sample size determination of cluster-unit trials",
      "authors": [
        "J Preisser",
        "M Young",
        "D Zaccaro"
      ],
      "year": 2003,
      "doi": "10.1002/sim.1379"
    },
    {
      "title": "On some small sample properties of generalized estimating equationEstimates for multivariate dichotomous outcomes",
      "authors": [
        "L Emrich",
        "M Piedmonte"
      ],
      "year": 1992,
      "doi": "10.1080/00949659208811388"
    },
    {
      "title": "Cluster randomised trials",
      "authors": [
        "R Hayes",
        "L Moulton"
      ],
      "year": 2017
    },
    {
      "title": "Covariance estimators for generalized estimating equations (GEE) in longitudinal analysis with small samples",
      "authors": [
        "M Wang",
        "L Kong",
        "Z Li"
      ],
      "year": 2016,
      "doi": "10.1002/sim.6817"
    },
    {
      "title": "A comparison of bias-corrected empirical covariance estimators with generalized estimating equations in small-sample longitudinal study settings",
      "authors": [
        "W Ford",
        "P Westgate"
      ],
      "year": 2018
    },
    {
      "title": "Small sample performance of bias-corrected sandwich estimators for cluster-randomized trials with binary outcomes",
      "authors": [
        "P Li",
        "D Redden"
      ],
      "year": 2015
    },
    {
      "title": "Cluster randomized trials with a small number of clusters: which analyses should be used?",
      "authors": [
        "C Leyrat",
        "K Morgan",
        "B Leurent"
      ],
      "year": 2018,
      "doi": "10.1093/ije/dyx169"
    },
    {
      "title": "Finite-sample corrected generalized estimating equation of population average treatment effects in stepped wedge cluster randomized trials",
      "authors": [
        "J Scott",
        "A Juraska"
      ],
      "year": 2017,
      "doi": "10.1177/0962280214552092"
    },
    {
      "title": "Sample size determination for GEE analyses of stepped wedge cluster randomized trials",
      "authors": [
        "F Li",
        "Turner Preisser"
      ],
      "year": 2018,
      "doi": "10.1111/biom.12918"
    },
    {
      "title": "Modified robust variance estimator for generalized estimating equations with improved smallsample performance",
      "authors": [
        "M Wang",
        "Q Long"
      ],
      "year": 2011,
      "doi": "10.1002/sim.4150"
    },
    {
      "title": "Robust covariance estimator for small-sample adjustment in the generalized estimating equations: a simulation study",
      "authors": [
        "M Gosho",
        "Y Sato",
        "H Takeuchi"
      ],
      "year": 2014,
      "doi": "10.11648/j.sjams.20140201.13"
    },
    {
      "title": "On the robust variance estimator in generalised estimating equations",
      "authors": [
        "W Pan"
      ],
      "year": 2001
    },
    {
      "title": "A simulation study of odds ratio estimation for binary outcomes from cluster randomized trials",
      "authors": [
        "O Ukoumunne",
        "J Carlin",
        "Gulliford Mc"
      ],
      "year": 2007
    },
    {
      "title": "A comparison of two bias-corrected covariance estimators for generalized estimating equations",
      "authors": [
        "B Lu",
        "J Preisser",
        "B Qaqish"
      ],
      "year": 2007
    },
    {
      "title": "Modeling clustered data with very few clusters",
      "authors": [
        "D Mcneish",
        "L Stapleton"
      ],
      "year": 2016,
      "doi": "10.1080/00273171.2016.1167008"
    },
    {
      "title": "Modified variance estimators for generalized estimating equations",
      "authors": [
        "Wang Geesmv"
      ],
      "year": 2015,
      "doi": "10.32614/cran.package.geesmv"
    },
    {
      "title": "SAS/STAT 9.2 user's guide",
      "year": 2008,
      "doi": "10.1007/s00362-008-0156-x"
    },
    {
      "title": "A bias correction for covariance estimators to improve inference with generalized estimating equations that use an unstructured correlation matrix",
      "authors": [
        "P Westgate"
      ],
      "year": 2013,
      "doi": "10.1002/sim.5709"
    },
    {
      "title": "xtgeebcv: A command for bias-corrected sandwich variance estimation for GEE analyses of cluster randomized trials",
      "authors": [
        "J Gallis"
      ],
      "year": 2020,
      "doi": "10.1177/1536867x20931001"
    },
    {
      "title": "A covariance correction that accounts for correlation estimation to improve finite-sample inference with generalized estimating equations: a study on its applicability with structured correlation matrices",
      "authors": [
        "P Westgate"
      ],
      "year": 2016,
      "doi": "10.1080/00949655.2015.1089873"
    },
    {
      "title": "On small-sample inference in group randomized trials with binary outcomes and cluster-level covariates",
      "authors": [
        "P Westgate"
      ],
      "year": 2013,
      "doi": "10.1002/bimj.201200237"
    },
    {
      "title": "Clustered data with small sample sizes: comparing the performance of model-based and design-based approaches",
      "authors": [
        "D Mcneish",
        "J Harring"
      ],
      "year": 2017,
      "doi": "10.1080/03610918.2014.983648"
    },
    {
      "title": "Stepped wedge randomised controlled trials: systematic review of studies published between 2010 and 2014",
      "authors": [
        "E Beard",
        "J Lewis",
        "A Copas"
      ],
      "year": 2015
    },
    {
      "title": "Systematic review finds major deficiencies in sample size methodology and reporting for stepped-wedge cluster randomised trials",
      "authors": [
        "J Martin",
        "M Taljaard",
        "A Girling"
      ],
      "year": 2016,
      "doi": "10.1136/bmjopen-2015-010166"
    },
    {
      "title": "R: A language and environment for statistical computing",
      "authors": [
        "Team Core"
      ],
      "year": 2016
    },
    {
      "title": "A method for generating high-dimensional multivariate binary variates",
      "authors": [
        "L Emrich",
        "M Piedmonte"
      ],
      "year": 1991
    },
    {
      "title": "The optimal design of stepped wedge trials with equal allocation to sequences and a comparison to other trial designs",
      "authors": [
        "J Thompson",
        "K Fielding",
        "J Hargreaves"
      ],
      "year": 2017,
      "doi": "10.1177/1740774517723921"
    },
    {
      "title": "Statistical efficiency and optimal design for stepped cluster studies under linear mixed effects models",
      "authors": [
        "A Girling",
        "K Hemming"
      ],
      "year": 2016
    },
    {
      "title": "The R package geepack for generalized estimating equations",
      "authors": [
        "U Halekoh",
        "S H\u00f8jsgaard"
      ],
      "year": 2006,
      "doi": "10.18637/jss.v015.i02"
    },
    {
      "title": "Impact on patients' treatment outcomes of XpertMTB/RIF implementation for the diagnosis of tuberculosis: follow-up of a stepped-wedge randomized clinical trial",
      "authors": [
        "A Trajman",
        "B Durovni",
        "V Saraceni"
      ],
      "year": 2015
    },
    {
      "title": "Designing a stepped wedge trial: three main designs, carry-over effects and randomisation approaches",
      "authors": [
        "A Copas",
        "J Lewis",
        "J Thompson"
      ],
      "year": 2015
    },
    {
      "title": "Working correlation structure misspecification, estimation and covariate design: implications for generalised estimating equations performance",
      "authors": [
        "Y Wang",
        "V Carey"
      ],
      "year": 2003,
      "doi": "10.1093/biomet/90.1.29"
    },
    {
      "title": "Reporting of stepped wedge cluster randomised trials: extension of the CONSORT 2010 statement with explanation and elaboration",
      "authors": [
        "K Hemming",
        "M Taljaard",
        "J Mckenzie"
      ],
      "year": 2018,
      "doi": "10.1136/bmj.k1614"
    },
    {
      "title": "Improving power in small-sample longitudinal studies when using generalized estimating equations",
      "authors": [
        "P Westgate",
        "W Burchett"
      ],
      "year": 2016,
      "doi": "10.1002/sim.6967"
    },
    {
      "title": "Comparison of population-averaged and subject-specific approaches for analyzing repeated binary outcomes",
      "authors": [
        "F Hu",
        "J Goldberg",
        "D Hedeker"
      ],
      "year": 1998
    },
    {
      "title": "Impact of non-uniform correlation structure on sample size and power in multipleperiod cluster randomised trials",
      "authors": [
        "J Kasza",
        "K Hemming",
        "R Hooper"
      ],
      "year": 2019
    }
  ],
  "num_references": 45
}
