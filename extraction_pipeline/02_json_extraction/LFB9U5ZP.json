{
  "paper_id": "LFB9U5ZP",
  "title": "Automated meal detection from continuous glucose monitor data through simulation and explanation",
  "abstract": "Background: Artificial pancreas systems aim to reduce the burden of type 1 diabetes by automating insulin dosing. These systems link a continuous glucose monitor (CGM) and insulin pump with a control algorithm, but require users to announce meals, without which the system can only react to the rise in blood glucose. Objective: We investigate whether CGM data can be used to automatically infer meals in daily life even in the presence of physical activity, which can raise or lower blood glucose. Materials and Methods: We propose a novel meal detection algorithm that combines simulations with CGM, insulin pump, and heart rate monitor data. When observed and predicted glucose differ, our algorithm uses simulations to test whether a meal may explain this difference. We evaluated our method on simulated data and real-world data from individuals with type 1 diabetes. Results: In simulated data, we detected meals earlier and with higher accuracy than was found in prior work (25.7 minutes, 1.2 g error; compared with 48.3 minutes, 17.2 g error). In real-world data, we discovered a larger number of plausible meals than was found in prior work (30 meals, 76.7% accepted; compared with 33 meals, 39.4% accepted). Discussion: Prior research attempted meal detection from CGM, but had delays and lower accuracy in real data or did not allow for physical activity. Our approach can be used to improve insulin dosing in an artificial pancreas and trigger reminders for missed meal boluses. Conclusions: We demonstrate that meal information can be robustly inferred from CGM and body-worn sensor data, even in challenging environments of daily life.",
  "year": 2019,
  "date": "2019-09-27",
  "journal": "Diabetes",
  "publication": "Diabetes",
  "authors": [
    {
      "forename": "Min",
      "surname": "Zheng",
      "name": "Min Zheng",
      "affiliation": "1  Computer Science , Stevens Institute of Technology , Hoboken , New Jersey , USA , and \n\t\t\t\t\t\t\t\t Computer Science \n\t\t\t\t\t\t\t\t Stevens Institute of Technology \n\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t\t Hoboken \n\t\t\t\t\t\t\t\t\t New Jersey \n\t\t\t\t\t\t\t\t\t USA"
    },
    {
      "forename": "Baohua",
      "surname": "Ni",
      "name": "Baohua Ni",
      "affiliation": "2  Electronic Engineering , Tsinghua Univer- sity , Beijing , China \n\t\t\t\t\t\t\t\t Electronic Engineering \n\t\t\t\t\t\t\t\t Tsinghua Univer- sity \n\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t\t Beijing \n\t\t\t\t\t\t\t\t\t China"
    },
    {
      "forename": "Samantha",
      "surname": "Kleinberg",
      "name": "Samantha Kleinberg",
      "affiliation": "1  Computer Science , Stevens Institute of Technology , Hoboken , New Jersey , USA , and \n\t\t\t\t\t\t\t\t Computer Science \n\t\t\t\t\t\t\t\t Stevens Institute of Technology \n\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t\t Hoboken \n\t\t\t\t\t\t\t\t\t New Jersey \n\t\t\t\t\t\t\t\t\t USA",
      "email": "samantha.kleinberg@stevens.edu"
    },
    {
      "affiliation": "Computer Science , Stevens Institute of Technology , 1 Castle Point on Hudson , Hoboken , NJ 07030 , USA; \n\t\t\t\t\t\t\t\t Computer Science \n\t\t\t\t\t\t\t\t Stevens Institute of Technology \n\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t\t 1 Castle Point on Hudson \n\t\t\t\t\t\t\t\t\t 07030 \n\t\t\t\t\t\t\t\t\t Hoboken \n\t\t\t\t\t\t\t\t\t NJ \n\t\t\t\t\t\t\t\t\t USA;"
    }
  ],
  "doi": "https://doi.org/10.13039/100000002",
  "keywords": [
    "diabetes mellitus type 1",
    "meal detection",
    "continuous glucose monitoring",
    "pancreas",
    "artificial"
  ],
  "sections": [
    {
      "title": "INTRODUCTION",
      "text": "Type 1 diabetes (T1D) is a chronic, lifelong disease that affects millions of individuals. 1 T1D is characterized by the inability to produce insulin, so individuals must manage their blood glucose (BG) using an insulin pump or injections. While meals are a key cause of BG changes, other factors such as stress and activity also affect BG and insulin sensitivity, making T1D complex to manage. Many complications of diabetes such as chronic kidney disease 2 are a result of long-term hyperglycemia (dangerously high BG).  3  Tight glycemic control can prevent microvascular complications of diabetes and yet tighter control increases the risk of hypoglycemia, which can lead to seizure, coma, and death.  4 esearchers have aimed to reduce the burden of T1D through artificial pancreas (AP) systems that measure glucose with continuous glucose monitors (CGMs), determine BG trajectory, and deliver insulin through a pump to automatically correct high values. CGMs measure glucose in fluid between cells as a proxy for BG, but because this is delayed relative to BG a rise in glucose may appear well after a meal has begun. AP systems either require users to provide input about their meals (making this no longer a closed loop) or infer meals from CGM data so that the system can correct for them. Most approaches to detect meals track glucose rate of change (ROC),  5  but in the real world, this is susceptible to false positives due to physical activity (which can increase BG) and noise. While the Glucose Rate Increase Detector (GRID)  6  addresses those challenges, this comes at the expense of delays in recognizing meals and GRID does not yet identify meal amount, as is needed for insulin dosing. Meal detection can also help identify missed meal insulin boluses,  7  which are associated with poor glycemic control.  8 o address this, we propose a method to detect meals and amount of carbohydrates consumed by combining CGM, insulin, and activity monitor data with a simulation of glucose. We build on the Food and Drug Administration-approved glucose-insulin model (GIM),  9, 10  which incorporates physical activity. When simulated and observed glucose differ significantly, that triggers a search for a meal that may explain the difference."
    },
    {
      "title": "Background",
      "text": "We aim to automatically infer meals from data collected by bodyworn sensors (specifically, CGM and activity sensors), as this allows for a fully automated solution. This is similar to finding latent variables (as meals are not directly observed), but prior work has aimed to identify causal structures with latent variables,  11  rather than to recover when latent events happen, as is needed for meal detection. A meal's effect on glucose could be viewed as a changepoint, but methods such as Bayesian online changepoint detection  12  only identify that a change has occurred (not why) and cannot provide the meal information needed to adjust insulin.\n\nThus, we focus on related work in detecting meals for T1D management. Many approaches use the ROC of CGM measurements,  6  as meals can lead to a rapid increase in BG. One approach tracking the speed of glucose changes combines a set of methods (eg, Kalman filters) to predict glucose, and identifies meals when they are supported by three-quarters of the methods.  5 Lee and Bequette  13  used Kalman filters to find meals and identified meal size by feeding the filtered glucose trajectory into a finite impulse response filter, where a meal is an impulse. The variable state dimension (VSD) approach 14 also builds on Kalman filters and identifies meal time and size simultaneously. However, these methods have high false positives in the presence of exercise  15  and stress,  16  as both can lead to an increase in glucose that could be mistaken for a meal. Further, meal detection is delayed, as the methods must wait until a meal affects BG enough to be distinguished from other factors that also increase BG, such as intense exercise.\n\nAs an alternative, Turksoy et al  17  introduced a multivariate adaptive model to detect meals using an unscented Kalman filter (UKF) for state estimations. However, due to the use of the UKF, parameter estimation may not converge to the true value, and instead can become stuck in a local minimum. Ramkissoon et al  18  also built on a UKF, but this approach not yet been evaluated on real-world data. Other approaches  19  use the minimal glucose physiological model,  20  modifying it to capture physiological trends and detect meals. This does not require tuning to individual parameters, but does not identify the meal size, as is needed to accurately estimate insulin needs.\n\nTable  1  summarizes the state of the art. Only 2 methods incorporate physical activity, and half were tested on real-world data. GRID  6  does both, but detects meals $42 minutes after they start, and did not evaluate meal size error. While Lee and Bequette  13  reported low meal size error, the approach was tested in simulations and without exercise, so it is unknown whether similar results will be obtained in the real world. VSD identified meal size  14  and has been applied to real-world data,  21  but it has significant delays and the meal size errors can lead to overestimates of insulin doses. Samadi et al  23  also identified meal size in real-world data, but with a high standard deviation in errors (28 g, roughly the amount of carbohydrates in a medium potato or banana). Further, that work evaluated meal size using the set of carbohydrate estimates within 2 hours of the start of the meal, making it difficult to compare results to methods that identify the meal and its quantity at the same time. We are not aware of any evaluations in real-world data in the presence of exercise. Our simulation-based explanation (SBE) approach instead finds meal times and amounts earlier and more accurately, enabling integration into insulin reminders and fully automated systems.\n\nSignificance 1. Earlier and more accurate meal detection: Unlike ROC-based methods, which cannot detect a meal until there is a large BG change, we leverage simulation to rapidly identify meals that explain changes from expected glucose. This allows insulin to be delivered earlier, preventing unhealthy glucose excursions. 2. Robustness to real-world challenges: Real-world CGM data are noisy, and many factors other than meals affect glucose. Other methods prioritize BG prediction, but this comes at the expense of meal detection, as errors compound throughout a day. We provide more robust results by allowing periodic restarts, and optimizing for meal detection by focusing on how well meals explain observed glucose. 3. Realistic evaluation: We evaluate accuracy for detecting meal time and size on realistic full-day simulations that include meals and physical activity, and on challenging real-world data."
    },
    {
      "title": "MATERIALS AND METHODS",
      "text": "We first formalize the problem and notation, then introduce the model we build on, and last, describe our approach for meal detection: SBE."
    },
    {
      "title": "Problem description and notation",
      "text": "Our primary motivation is improving AP systems, which use a CGM and insulin pump. Thus, we assume that these data sources are available. The pump records continuous basal insulin (pmol/kg/ min) and discrete insulin boluses (pmol/kg). CGMs measure glucose (mg/dL) at 5-minute intervals. We assume that individual information is available (body weight, resting heart rate [HR]), individuals wear an activity tracker capturing heart rate, and meals are the only unmeasured variable affecting BG. However, in experimental results, we demonstrate that our approach succeeds even when this does not hold. We denote the data by D \u00bc \u00bdG; HR; B; I], where each bold variable is a time series. G \u00bc \u00bdG 1 \u00f0 \u00de; . . . ; G n \u00f0 \u00de is a subject's glucose from time 1 to time n, HR denotes heart rate, B is insulin boluses, and I the insulin infusion rate at each time point. Because these devices record at different frequencies, we synchronize all to the 5-minute rate of the CGM.\n\nOur task is using observations to detect meals, meaning their start time (m st ), duration (m du ), and size (m c , grams of carbohydrates)."
    },
    {
      "title": "Background: GIM",
      "text": "Our approach relies on simulation, rather than fitting to the observed glucose as in other approaches, such as VSD  14  and GRID,  6  as this lets us overcome measurement errors. We build on GIM,  9,10,24,  which is well validated and models the effect of physical activity on glucose.\n\nThe main parts of GIM are endogenous glucose production, glucose utilization, and how exercise influences glucose. Glucose utilization includes insulin-independent utilization U ii \u00f0t\u00de (constant glucose uptake by the brain and erythrocytes) and insulin-dependent utilization U id \u00f0t\u00de (the effect of endogenous and exogenous insulin). Total glucose utilization U at time t is\n\nTo incorporate physical activity, GIM builds on Breton,  25  whose approach linked insulin action and glucose effectiveness to current HR (HR\u00f0t\u00de) and basal heart rate (HR b ). The approach models changes in glucose uptake due to energy consumption (Y) and insulin action (Z):\n\nThe variables T HR ; T in ; and T ex are parameters to model the physiological reaction to energy expenditure and exercise. To model the effect of exercise on insulin-dependent glucose utilization, U id \u00f0t\u00de, Dalla Man et al 10 added a scale variable W\u00f0t\u00de defined as\n\nwhere t z is the end of the activity's effect on insulin action, Z. Exercise (reflected in HR) has a cumulative effect, but is modeled with a step increase in HR. As we discuss in the following section, we use HR measurements at each time to capture exercise intensity."
    },
    {
      "title": "Meal detection using SBE",
      "text": "Our method has 3 parts: (1) find when observed glucose diverges from predicted glucose, (2) generate predicted glucose for potential meals using GIM, and (3) test if potential meals explain observed glucose. Figure  1  shows an overview."
    },
    {
      "title": "Find diverging point",
      "text": "First, we must determine when to search for a meal. To do this efficiently, we identify times when observed and predicted glucose differ, and then determine whether this difference can be explained by a meal. We continually update the insulin infusion rate IIR\u00f0t\u00de and boluses using the insulin pump data at each t and update HR\u00f0t\u00de in equation 5 using the HR data. Thus, GIM is updated with observed variables \u00f0HR; B; I\u00de (all except G), to obtain the predicted glucose time series G 0 . We aim to determine when the difference between G and G 0 is large enough that a meal may explain it. As CGM data can be noisy, we first smooth G using Savitzky-Golay filter,  26  then compare the means of G 0 and G over a window f. This handles the noise and outlying values of CGM data better than comparison at a single time point. When the difference between G 0 and G is greater than a threshold /, we call this time point t the diverging point. More formally, we test\n\nwhere G 0 \u00bdt \u00c0 f : t denotes the mean of G 0 from time t \u00c0 f to time t. We set / as a percent of the mean observed glucose (5% in this work)."
    },
    {
      "title": "Generate predicted glucose sequence",
      "text": "When t is a diverging point, the algorithm then searches for a meal that may have begun before t. A meal is defined as m \u00bc \u00bdm st ; m c ; m du ; with m st being the start time, m c being the meal size (grams of carbohydrates), and m du being the meal duration. To constrain the search space, we set a maximum meal duration C; maximum meal size m max , and maximum lag s between meal start and when glucose diverges. Thus, t\u00c0s m st t. We then perform a grid search over combinations of meal timing (start, duration) and size, generating predicted glucose G 0 for each meal, and comparing it against the observed glucose. For efficiency, we begin with a resolution of 1 g for meal size and 2 minutes for meal time until d Euc < 2e. Then we perform a finer search, using 0.1 g and 1 minutes. These values were chosen as a tradeoff between efficiency and precision.\n\nFor each potential meal m, we update the parameters in GIM beginning at m st . In GIM, glucose at time t is proportional to the carbohydrate ingestion rate d d t \u00f0 \u00de (in mg/min):\n\nWe assume that meals are consumed at a constant rate, as this is more realistic than assuming all carbohydrates are ingested at a single time as in other approaches. Thus, the ingestion rate at time t is:\n\nUpdating d d t \u00f0 \u00de at each time t during the meal yields the predicted glucose G 0 for each potential meal m."
    },
    {
      "title": "Meal detection",
      "text": "After simulating G 0 for all potential meals, m we must determine which meals (if any) explain the observed glucose G. We accept a meal when the average Euclidean distance, d Euc , between G 0 and G is smaller than a threshold e. For a diverging point t and potential meal m \u00bc \u00bdm st ; m st \u00fe m du , d Euc is:\n\nIf multiple meals have d Euc < e, we select the one with the lowest d Euc . The value for e was chosen after tuning (see the Supplementary Appendix for details on this and algorithmic complexity).\n\nFigure  1  shows an overview of SBE. We start with observed glucose (solid line) and find when it diverges from predicted glucose (dotted line). Then, we search for meals that may explain the difference. After generating predicted glucose trajectories (dashed lines), we detect the meal (green bar) that accounts best for the observed glucose."
    },
    {
      "title": "Experimental approach",
      "text": "We evaluate our approach using simulated data with ground truth and real-world data in which meal information is missing and must be inferred. While the real-world data do not have ground truth, using operational criteria, we demonstrate that our approach works in realistic cases. We compare our approach with VSD, following the details and parameter settings of Xie and Wang.  21 We selected this method for comparison because it detects meals and their size simultaneously and has been previously applied to real-world data with high accuracy."
    },
    {
      "title": "Simulated data",
      "text": "We first evaluate whether the algorithms can detect a full day of meals in the presence of exercise. All simulations are created using our implementation of the GIM. Experiments for parameter estimation are described in the Supplementary Appendix. We first generate a representative day, before generating a cohort of 100 individuals. For the single day, we use the parameters: body weight 60 kg, basal HR 60 beats/min, and basal insulin rate 2.5 pmol/kg/min. The sequence of events is shown in Figure  2  and Table  2 .\n\nWe then simulate 100 more individuals for 24 hours each with 1 episode of exercise, varying the parameters for body weight (40-90 kg), exercise duration (30-50 minutes), meal duration (10-40 minutes), meal size (10-50 g), and meal start time.\n\nOur primary evaluation metrics are delay and meal size error. Delay is the difference between when a meal is identified and the actual meal start time. This metric is critical because identifying a meal more quickly allows earlier bolus reminders or insulin adjustment via an AP. Meal size error is the difference in grams of carbohydrates between the detected meal and ground truth. This information is necessary for accurate insulin dosing. We additionally evaluate recall and precision of eating minutes. Recall is how much eating time is correctly recovered, and precision is how much identified eating time is actually during a meal."
    },
    {
      "title": "Real-world data",
      "text": "To evaluate our approach on real-world data, we use the Diabetes Management Integrated Technology Research Initiative (DMITRI) dataset.  28 DMITRI includes data for 17 individuals (10 men, 7 women) in daily life for 3 days each (around 72 hours). Participants were active, exercising 2-3 times per week (13 of 17, >4 times per week), and during the study activities included running, cycling, and yoga. The data used here are glucose (Dexcom 7\u00fe CGM), insulin basal and bolus rates (insulin pumps), and HR (Polar chest strap). Participants used their own insulin pumps. The HR and insulin data were synchronized to the 5-minute intervals of the CGM. At the beginning of data collection, body weight and resting HR were recorded. To handle missing CGM data (mean 24.6% missing), we use the imputation approach of Rahman et al,  27  which had high accuracy on this dataset. We excluded 2 individuals with >40% missing data. After imputation, we had 1437 hours of data for 15 people (8 men, 7 women).\n\nThe key difference from simulation is in evaluation. While participants photographed their meals, these data were not synchronized to the rest and is not part of the publicly available DMITRI dataset, so there were no ground truth meal times. Thus, we use operational criteria based on prior work to determine if inferences are plausible. We accept a meal if (1) it happens before an increase in BG and (2) BG increases by 4 mg/dL within 30 minutes after the meal starts. This threshold is commonly used in works on identifying meal onset from CGM data.  13, 14 This approach allows quantitative evaluation of the algorithms, but it remains possible that there are true meals that do not meet this criteria or nonmeal factors that do. We also examine whether there is a nearby insulin bolus, as boluses are generally administered in conjunction with a meal.\n\nFor our approach, we set body weight and resting HR using the measured value for each subject. We set f \u00bc 30 minutes (the length of time series used to trigger meal search). As CGM data are every 5 minutes, this allows us to use 6 data points rather than only 2. Similarly, we set / \u00bc 10% (threshold for identifying a diverging point) and e \u00bc 5 mg/dL (threshold for average Euclidean distance) due to the noise in real data. For the maximum delay between the start of a meal and the diverging point, we set s \u00bc 60 minutes. For VSD we use the parameter settings specified by Xie and Wang.  21"
    },
    {
      "title": "RESULTS"
    },
    {
      "title": "Results on simulated data",
      "text": "We begin by discussing the case study, then the results for a simulated cohort of 100 individuals. Both use a 24-hour day with 3 meals at varying times plus exercise of varied duration and intensity. This is challenging, as the effect of one event (exercise, meal) may persist past the start of another.\n\nFigure  2  shows results for both methods on the case study. First, we detect breakfast of the exact duration and size as the ground truth 25 minutes after it begins, and starting 1 minute earlier (recall 95%, precision 94.7%). VSD also identifies the meal start time with a 25-minute delay, but overestimates size by 1.5 g. We detect lunch with a 30-minute delay, with high accuracy for meal size (24.7 g ground truth, 25 g inferred), but VSD identifies a meal of 56.3 g with a 45-minute delay, which is a substantial overestimate. Finally, we detect dinner 26 minutes after it begins, again with high accuracy (40 g detected, 40.8 g ground truth). In contrast, with a delay of 50 minutes, VSD finds a meal of 80.3 g, which is nearly double the actual meal size, and would lead to a dramatic overestimate of insulin if used for dosing. Across the whole day, our approach has an average delay of 27 minutes vs 40 minutes for VSD. We estimate all meals to within 1 g, while VSD has an average meal size error of 23.3 g. This suggests that our approach can be accurately used for estimating insulin.\n\nResults for the 100 simulated individuals for the full day are shown in Table  3 . Our approach detects meals sooner (mean 25.7 6 5 minutes) than VSD (48.3 6 9 minutes) and with lower meal size error (1.2 6 3.6 g) than VSD (17.2 6 8 g). This difference would have a substantial impact on insulin dosing. Note that VSD assumes that a meal is ingested at a single time point (ie, it does not have a duration), which is unrealistic and may contribute to errors."
    },
    {
      "title": "Meal detection on real-world data",
      "text": "We now show that it is possible to apply our approach to real-world data. This is challenging, as data can be missing, sensors are noisy, and many unobservable factors affect BG. Nevertheless, we show that in this challenging environment, our approach recovers a larger number of plausible meals than VSD does.\n\nOn the DMITRI dataset, our approach detected 30 meals, with 23 (76.7%) accepted as plausible and 7 (23.3%) rejected using our operational criteria. VSD detected 33 meals, but only 13 (39.4%) were accepted and 20 (61.6%) were rejected. Thus our approach has both more true positives and fewer false positives. We discuss 4 representative cases (breakfast, lunch, dinner, snacks). Full results for all subjects are in the Supplementary Appendix.\n\nFigure  3A  shows a breakfast detected by both methods, around 6:00 AM However, VSD detects a second meal at 8:20 AM around the time an insulin bolus is given, even though glucose has a downward trend at the time. In Figure  3B , there is a smaller afternoon meal (3:00 PM) and then what we expect is dinner based on the timing. Both methods detect the snack, but VSD detects the second meal too early, at a time when glucose is still decreasing and far from the insulin bolus. Our approach detects a more reasonable meal time. For lunch (Figure  3C ), both methods detect a meal starting around 12:30 PM, but VSD has a false positive at 4:20 PM, while glucose is Table  2 . Detailed series of events for the whole-day simulation depicted in Figure  2  Time Event decreasing and almost an hour after an insulin bolus. For the dinner in Figure  3D , we detect a meal beginning at 7:00 PM This time is close to an insulin bolus and glucose increases right after the identified meal. In contrast, VSD detected a meal starting at 9:00 PM, which is well after the initial rise in glucose and just before a second insulin bolus. Overall, while VSD detected 13 plausible meals, it also often (5 times) found a second false meal afterward, detected a meal with a significant delay, or detected meals while BG was decreasing (20 total rejected meals). Because VSD uses the error between predicted and observed glucose to detect the onset of a meal, when the error is negative and larger than the threshold, it erroneously detects a meal. However, detecting extra meals, especially if an insulin bolus has already been given, could lead to dangerously low BG if used in an AP."
    },
    {
      "title": "DISCUSSION"
    },
    {
      "title": "Implications for diabetes treatment",
      "text": "Identifying meals automatically can have a substantial impact on treatment of T1D, by allowing automated insulin dosing in an AP, or reminding individuals about missed insulin boluses with meals. While prior work has attempted to identify meals from CGM data, meals and their quantity have not been inferred together in realworld data that also include physical activity. Our approach outperformed VSD on both simulated and real-world data. We further showed that meal times and their quantities can be reliably inferred from CGM data even in the presence of physical activity in noisy real-world environments. The reduced delay and higher accuracy of our approach yields more actionable information for insulin dosing with fewer potentially dangerous false positives and better estimation of insulin needs. Integrating meal detection with an AP may allow a fully closed-loop system that does not have to wait for glycemic excursions to adjust insulin-reducing variation in BG. Our identification of meals can be used to prompt both reminders for missed meal boluses as well as suggestions for the size of the bolus needed. Beyond fully automated BG control via an AP, our work can be extended to help individuals learn to better manage their BG. One potentially significant area of future work is identifying not only missed, but also inaccurate (eg, too small) meal boluses. This can be done by simulating different sized boluses than the actual one given to identify the optimal quantity and by providing this feedback Delay is time between meal start and its detection and size error is in grams of carbohydrates. Recall and precision for VSD are at the meal level, rather than at the minute level, as it does not infer duration.\n\nVSD: variable state dimension.\n\na Best result for the metric and experiment. to patients. Owing to the lifelong nature of T1D, a deployed system in the real world will have significantly more than 3 days of data on each individual. A promising avenue for future work is investigating personalization, which may be able to further reduce the time needed to detect a meal by adapting to each individual's glycemic response."
    },
    {
      "title": "Incorporating other factors affecting glycemia",
      "text": "One of the reasons diabetes is so difficult to manage is that many factors, including stress,  28, 29  sleep,  30  and hormonal cycles,  31, 32  may influence glycemia. These factors are not accounted for by any existing meal detection algorithm. However, there are now wearable sensors and apps that can automatically measure or track these factors.\n\nFor example, wristbands such as the Empatica E4 (Empatica, Milan, Italy) track stress with electrodermal activity, consumer devices such as the Fitbit (Fitbit, Inc, San Francisco, CA) track sleep, and there are numerous apps for tracking menstrual cycles.  33 Ultimately, we believe that these signals could be automatically integrated with our work to more accurately detect meals and provide better guidance on insulin dosage. While patients are mainly taught to count carbohydrates, meals with the same carbohydrate content but different protein and fat can lead to different glycemic responses.  [34] [35] 5] [36]  Dosing suggestions and feedback can ultimately be improved by integrating our meal detection module and information on foods consumed such as from recently developed methods for automated dietary monitoring.  37, 38"
    },
    {
      "title": "CONCLUSION",
      "text": "We introduced SBE, a new approach to automated meal detection that combines simulation with observations of glucose and activity to robustly identify meals even in noisy data. On simulated data, we detect meals on average 10 minutes sooner than VSD, with an average error of only 1.2 g compared with 17.2 g in prior work. On realworld data, our approach finds a larger number of plausible meals while making fewer false positives. In future work, we aim to develop an online version of the approach that could be run efficiently as part of an AP and to incorporate data from other body-worn sensors that capture other factors that influence glucose (sleep, stress). Ultimately, our approach may be used to automatically provide meal information to an AP and remind individuals managing their own diabetes about missed insulin doses."
    },
    {
      "text": "Figure1. Overview of method: (A) identify times in which observed glucose differs significantly from predicted glucose, (B) simulate glucose trajectories with varying meal sizes and times, and (C) determine which, if any, inferred meals account best for observed glucose. BG: blood glucose."
    },
    {
      "text": "Figure 2. Twenty-four hours of simulated data with ground truth meals (gray boxes), insulin doses (vertical black bars in meals), and exercise (light gray box).Our approach finds all meals with low error (bars show meal duration), while variable state dimension (VSD) has significant error in meal size estimate (circles show meal time). Meals for both methods are shaded to indicate meal size error (dark blue \u00bc 0, yellow \u00bc 40-g error)."
    },
    {
      "text": "Insulin bolus, 70 pmol/kg 12:00-12:30 PM Lunch, 24.7-g carbohydrates 12:10 PM Insulin bolus, 80 pmol/kg 5:00-5:30 PM Run, average HR 140 beats/min 6:00-6:40 PM Dinner, 40.8-g carbohydrates 6:05 PM Insulin bolus, 80 pmol/kg HR: heart rate."
    },
    {
      "text": "Figure 3. Real-world continuous glucose (GLU) monitor (gray line) and insulin bolus data (vertical black bars) with accepted meals (black bar for our method or black circle for variable state dimension [VSD]) and rejected meals (gray bar for our method or gray X for VSD), smoothed GLU (dashed blue), our predicted GLU (orange line), and VSD-predicted GLU (green line). (A) Subject A (breakfast). (B) Subject B (snacks and dinner). (C) Subject C (lunch). (D) Subject D (dinner)."
    },
    {
      "text": "Related work in meal detection from continuous glucose monitoringValues are mean 6 SD or range, unless otherwise indicated. Meal size error is given in grams of carbohydrates. GRID: Glucose Rate Increase Detector; MDA: meal detection algorithm; NR: not reported; SBE: simulation-based explanation; VSD: variable state dimension."
    },
    {
      "text": "Experimental results for 100 simulated people"
    }
  ],
  "references": [
    {
      "title": "The rise of childhood type 1 diabetes in the 20th century",
      "authors": [
        "E Gale"
      ],
      "year": 2002,
      "doi": "10.2337/diabetes.51.12.3353"
    },
    {
      "title": "National Kidney Foundation practice guidelines for chronic kidney disease: evaluation, classification, and stratification",
      "authors": [
        "A Levey",
        "J Coresh",
        "E Balk"
      ],
      "year": 2003
    },
    {
      "title": "The diabetes control and complications trial/epidemiology of diabetes interventions and complications study at 30 years: overview",
      "authors": [
        "D Nathan",
        "F Group"
      ],
      "year": 2014,
      "doi": "10.2337/dc13-2112"
    },
    {
      "title": "Hypoglycaemia in diabetes mellitus: epidemiology and clinical implications",
      "authors": [
        "B Frier"
      ],
      "year": 2014,
      "doi": "10.1038/nrendo.2014.170"
    },
    {
      "title": "Detection of a meal using continuous glucose monitoring",
      "authors": [
        "E Dassau",
        "B Bequette",
        "B Buckingham",
        "F Doyle"
      ],
      "year": 2008,
      "doi": "10.2337/dc07-1293"
    },
    {
      "title": "Design of the glucose rate increase detector: a meal detection module for the health monitoring system",
      "authors": [
        "R Harvey",
        "E Dassau",
        "H Zisser",
        "D Seborg",
        "F Doyle"
      ],
      "year": 2014,
      "doi": "10.1177/1932296814523881"
    },
    {
      "title": "Insulin adherence behaviours and barriers in the multinational global attitudes of patients and physicians in insulin therapy study",
      "authors": [
        "M Peyrot",
        "A Barnett",
        "L Meneghini",
        "P-M Schumm-Draeger"
      ],
      "year": 2012,
      "doi": "10.1111/j.1464-5491.2012.03605.x"
    },
    {
      "title": "Differences in the management of type 1 diabetes among adults under excellent control compared with those under poor control in the T1D exchange clinic registry",
      "authors": [
        "J Simmons",
        "V Chen",
        "K Miller"
      ],
      "year": 2013,
      "doi": "10.2337/dc12-2643"
    },
    {
      "title": "GIM, simulation software of meal glucose-insulin model",
      "authors": [
        "C Dalla Man",
        "D Raimondo",
        "R Rizza",
        "C Cobelli"
      ],
      "year": 2007
    },
    {
      "title": "Physical activity into the meal glucose-insulin model of type 1 diabetes: in silico studies",
      "authors": [
        "C Dalla Man",
        "M Breton",
        "C Cobelli"
      ],
      "year": 2009,
      "doi": "10.1177/193229680900300107"
    },
    {
      "title": "On causal discovery from time series data using FCI",
      "authors": [
        "D Entner",
        "P Hoyer"
      ],
      "year": 2010
    },
    {
      "title": "Bayesian online changepoint detection",
      "authors": [
        "R Adams",
        "D Mackay"
      ],
      "year": 2007
    },
    {
      "title": "A closed-loop artificial pancreas based on model predictive control: Human-friendly identification and automatic meal disturbance rejection",
      "authors": [
        "H Lee",
        "B Bequette"
      ],
      "year": 2009,
      "doi": "10.1016/j.bspc.2009.03.002"
    },
    {
      "title": "Meal detection and meal size estimation for type 1 diabetes treatment: a variable state dimension approach",
      "authors": [
        "J Xie",
        "Q Wang"
      ],
      "year": 2015
    },
    {
      "title": "Exercise in type 1 diabetes",
      "authors": [
        "J Grimm"
      ],
      "year": 2005,
      "doi": "10.1002/0470022086.ch2"
    },
    {
      "title": "Stress hyperglycemia and prognosis of stroke in nondiabetic and diabetic patients: a systematic overview",
      "authors": [
        "S Capes",
        "D Hunt",
        "K Malmberg",
        "P Pathak",
        "H Gerstein"
      ],
      "year": 2001,
      "doi": "10.1161/hs1001.096194"
    },
    {
      "title": "Meal detection in patients with type 1 diabetes: a new module for the multivariable adaptive artificial pancreas control system",
      "authors": [
        "K Turksoy",
        "S Samadi",
        "J Feng",
        "E Littlejohn",
        "L Quinn",
        "A Cinar"
      ],
      "year": 2016,
      "doi": "10.1109/jbhi.2015.2446413"
    },
    {
      "title": "Meal detection in the artificial pancreas: implications during exercise",
      "authors": [
        "C Ramkissoon",
        "P Herrero",
        "J Bondia",
        "J Vehi"
      ],
      "year": 2017,
      "doi": "10.1016/j.ifacol.2017.08.1083"
    },
    {
      "title": "Physiology-invariant meal detection for type 1 diabetes",
      "authors": [
        "J Weimer",
        "S Chen",
        "A Peleckis",
        "M Rickels",
        "I Lee"
      ],
      "year": 2016,
      "doi": "10.1089/dia.2015.0266"
    },
    {
      "title": "Toward physiological understanding of glucose tolerance: minimal-model approach",
      "authors": [
        "R Bergman"
      ],
      "year": 1989,
      "doi": "10.2337/diab.38.12.1512"
    },
    {
      "title": "A variable state dimension approach to meal detection and meal size estimation: in silico evaluation through basal-bolus insulin therapy for type 1 diabetes",
      "authors": [
        "J Xie",
        "Q Wang"
      ],
      "year": 2017
    },
    {
      "title": "Meal detection based on nonindividualized moving horizon estimation and classification",
      "authors": [
        "K Ko \u00a8lle",
        "A Fougner",
        "\u00d8 Stavdahl"
      ],
      "year": 2017,
      "doi": "10.1109/ccta.2017.8062516"
    },
    {
      "title": "Automatic detection and estimation of unannounced meals for multivariable artificial pancreas system",
      "authors": [
        "S Samadi",
        "M Rashid",
        "K Turksoy"
      ],
      "year": 2018,
      "doi": "10.1089/dia.2017.0364"
    },
    {
      "title": "Meal simulation model of the glucoseinsulin system",
      "authors": [
        "C Dalla Man",
        "R Rizza",
        "C Cobelli"
      ],
      "year": 2007,
      "doi": "10.1109/tbme.2007.893506"
    },
    {
      "title": "Physical activity-the major unaccounted impediment to closed loop control",
      "authors": [
        "M Breton"
      ],
      "year": 2008,
      "doi": "10.1177/193229680800200127"
    },
    {
      "title": "Smoothing and differentiation of data by simplified least squares procedures",
      "authors": [
        "A Savitzky",
        "M Golay"
      ],
      "year": 1964,
      "doi": "10.1021/ac60214a047"
    },
    {
      "title": "Combining Fourier and lagged k-nearest neighbor imputation for biomedical time series data",
      "authors": [
        "S Rahman",
        "Y Huang",
        "J Claassen",
        "N Heintzman",
        "S Kleinberg"
      ],
      "year": 2015,
      "doi": "10.1016/j.jbi.2015.10.004"
    },
    {
      "title": "Daily stress and glycaemic control in Type 1 diabetes: individual differences in magnitude, direction, and timing of stress-reactivity",
      "authors": [
        "A Riazi",
        "J Pickup",
        "C Bradley"
      ],
      "year": 2004,
      "doi": "10.1016/j.diabres.2004.04.001"
    },
    {
      "title": "Association between stress and glycemic control in adults with type 1 (insulin-dependent) diabetes",
      "authors": [
        "C Lloyd",
        "P Dyer",
        "R Lancashire",
        "T Harris",
        "J Daniels",
        "A Barnett"
      ],
      "year": 1999,
      "doi": "10.2337/diacare.22.8.1278"
    },
    {
      "title": "Analysis of nocturnal continuous glucose and sleep stage data in adults with type 1 diabetes in real-world conditions",
      "authors": [
        "S Feupe",
        "P Frias",
        "S Mednick",
        "E Mcdevitt",
        "N Heintzman"
      ],
      "year": 2013
    },
    {
      "title": "Menstrual cycle effects on insulin sensitivity in women with type 1 diabetes: a pilot study",
      "authors": [
        "K Trout",
        "M Rickels",
        "M Schutta"
      ],
      "year": 2007,
      "doi": "10.1089/dia.2006.0004"
    },
    {
      "title": "Cyclic changes in glycemia assessed by continuous glucose monitoring system during multiple complete menstrual cycles in women with type 1 diabetes",
      "authors": [
        "W Goldner",
        "V Kraus",
        "W Sivitz",
        "S Hunter",
        "J Dillon"
      ],
      "year": 2004
    },
    {
      "title": "Can menstrual health apps selected based on users' needs change health-related factors? A double-blind randomized controlled trial",
      "authors": [
        "J Lee",
        "J Kim"
      ],
      "year": 2019,
      "doi": "10.1093/jamia/ocz019"
    },
    {
      "title": "The role of dietary protein and fat in glycaemic control in type 1 diabetes: implications for intensive diabetes management",
      "authors": [
        "M Paterson",
        "K Bell",
        "O' Connell",
        "S Smart",
        "C Shafat",
        "A King"
      ],
      "year": 2015
    },
    {
      "title": "Protein and fat effects on glucose responses and insulin requirements in subjects with insulin-dependent diabetes mellitus",
      "authors": [
        "A Peters",
        "M Davidson"
      ],
      "year": 1993,
      "doi": "10.1093/ajcn/58.4.555"
    },
    {
      "title": "Impact of fat, protein, and glycemic index on postprandial glucose control in type 1 diabetes: implications for intensive diabetes management in the continuous glucose monitoring era",
      "authors": [
        "K Bell",
        "C Smart",
        "G Steil",
        "J Brand-Miller",
        "B King",
        "H Wolpert"
      ],
      "year": 2015,
      "doi": "10.2337/dc15-0100"
    },
    {
      "title": "Automated estimation of food type and amount consumed from body-worn audio and motion sensors",
      "authors": [
        "M Mirtchouk",
        "C Merck",
        "S Kleinberg"
      ],
      "year": 2016,
      "doi": "10.1145/2971648.2971677"
    },
    {
      "title": "Automated estimation of food type from body-worn audio and motion sensors in free-living environments",
      "authors": [
        "M Mirtchouk",
        "A Deierlein",
        "S Kleinberg"
      ],
      "year": 2019,
      "doi": "10.1145/2971648.2971677"
    }
  ],
  "num_references": 38
}
